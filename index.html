<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Ñ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏≠‡πÇ‡∏≠‡∏ó‡∏µ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .scanner-input {
            font-family: 'Courier New', monospace;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse-success {
            animation: pulseSuccess 0.5s ease-in-out;
        }
        @keyframes pulseSuccess {
            0% { background-color: rgb(34, 197, 94); }
            50% { background-color: rgb(22, 163, 74); }
            100% { background-color: rgb(34, 197, 94); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">üì¶ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Ñ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏≠‡πÇ‡∏≠‡∏ó‡∏µ</h1>
            <p class="text-gray-600">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets</p>
        </div>

        <!-- Navigation Tabs -->
        <div class="bg-white rounded-xl shadow-lg mb-6">
            <div class="flex border-b">
                <button onclick="showTab('receive')" id="tab-receive" class="flex-1 py-4 px-6 text-center font-medium border-b-2 border-blue-500 text-blue-600 bg-blue-50">
                    üì• ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤
                </button>
                <button onclick="showTab('issue')" id="tab-issue" class="flex-1 py-4 px-6 text-center font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700">
                    üì§ ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢
                </button>
                <button onclick="showTab('overview')" id="tab-overview" class="flex-1 py-4 px-6 text-center font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700">
                    üìä ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
                </button>
                <button onclick="showTab('settings')" id="tab-settings" class="flex-1 py-4 px-6 text-center font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700">
                    ‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                </button>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings-tab" class="hidden">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Google Apps Script URL</label>
                        <input type="url" id="sheets-url" placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec" 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">API Key (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                        <input type="password" id="api-key" placeholder="‡πÉ‡∏™‡πà API Key ‡∏Ç‡∏≠‡∏á Google Sheets" 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="auto-sync" class="mr-2">
                        <label for="auto-sync" class="text-sm text-gray-700">‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label>
                    </div>
                    <div class="flex gap-4">
                        <button onclick="testConnection()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                            üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                        </button>
                        <button onclick="clearAllData()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                            üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                        </button>
                    </div>
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <h3 class="font-medium text-yellow-800 mb-2">üìã ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Apps Script:</h3>
                        <ol class="text-sm text-yellow-700 space-y-1 list-decimal list-inside">
                            <li>‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets ‡πÉ‡∏´‡∏°‡πà</li>
                            <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà Extensions ‚Üí Apps Script</li>
                            <li>‡∏ß‡∏≤‡∏á Code ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÉ‡∏ô Apps Script</li>
                            <li>Deploy as Web App ‚Üí Execute as: Me ‚Üí Who has access: Anyone</li>
                            <li>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</li>
                        </ol>
                        <div class="mt-3 p-3 bg-gray-100 rounded text-xs overflow-x-auto">
                            <strong>Google Apps Script Code (‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î):</strong><br>
                            <pre class="mt-2 text-xs"><code>function doPost(e) {
  try {
    const sheet = SpreadsheetApp.getActiveSheet();
    const data = JSON.parse(e.postData.contents);
    
    if (data.action === 'test') {
      return ContentService
        .createTextOutput(JSON.stringify({success: true, message: 'Connection OK'}))
        .setMimeType(ContentService.MimeType.JSON);
    }
    
    if (data.action === 'updateInventory' && data.data && data.data.length > 0) {
      // Clear existing data
      sheet.clear();
      
      // Set headers
      const headers = Object.keys(data.data[0]);
      sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
      
      // Set data
      const rows = data.data.map(item => headers.map(h => item[h] || ''));
      if (rows.length > 0) {
        sheet.getRange(2, 1, rows.length, headers.length).setValues(rows);
      }
      
      return ContentService
        .createTextOutput(JSON.stringify({success: true, rows: rows.length}))
        .setMimeType(ContentService.MimeType.JSON);
    }
    
    return ContentService
      .createTextOutput(JSON.stringify({success: false, error: 'Invalid action'}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

function doGet(e) {
  return ContentService
    .createTextOutput(JSON.stringify({success: true, message: 'IoT Inventory API Ready'}))
    .setMimeType(ContentService.MimeType.JSON);
}</code></pre>
                        </div>
                        <div class="mt-3 p-3 bg-blue-50 rounded text-xs">
                            <strong>‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£ Deploy</strong><br>
                            1. ‡∏ß‡∏≤‡∏á Code ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‚Üí Save<br>
                            2. ‡∏Ñ‡∏•‡∏¥‡∏Å Deploy ‚Üí New deployment<br>
                            3. Type: Web app<br>
                            4. Execute as: <strong>Me</strong><br>
                            5. Who has access: <strong>Anyone</strong><br>
                            6. Deploy ‚Üí Copy URL ‚Üí ‡∏ô‡∏≥‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
                        </div>
                    </div>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4">
                        <h3 class="font-medium text-blue-800 mb-2">üíæ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå</h3>
                        <div class="text-sm text-blue-700 space-y-1">
                            <p>‚úÖ <strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏≤‡∏ß‡∏£:</strong> ‡πÉ‡∏ä‡πâ IndexedDB ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á - ‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢‡πÅ‡∏°‡πâ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå</p>
                            <p>üîÑ <strong>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏≠‡∏á:</strong> ‡∏°‡∏µ localStorage ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Å‡∏£‡∏ì‡∏µ IndexedDB ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</p>
                            <p>üåê <strong>‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</strong> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ - ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</p>
                            <p>‚ö° <strong>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå:</strong> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÄ‡∏ö‡∏¥‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>
                            <p id="sync-status" class="font-medium">üîÑ <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå...</p>
                        </div>
                        <div class="mt-3 flex items-center">
                            <input type="checkbox" id="cloud-sync-toggle" checked class="mr-2">
                            <label for="cloud-sync-toggle" class="text-sm text-blue-700">‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Receive Tab -->
        <div id="receive-tab">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">üì• ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏ï‡πá‡∏≠‡∏Ñ</h2>
                <form onsubmit="receiveItem(event)" class="space-y-4">
                    <div class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üîç ‡πÅ‡∏™‡∏Å‡∏ô/‡πÉ‡∏™‡πà Serial Number (‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß)</label>
                            <textarea id="receive-sn" placeholder="‡πÅ‡∏™‡∏Å‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå SN (‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏Ñ‡∏∑‡∏≠ SN ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß)&#10;‡πÄ‡∏ä‡πà‡∏ô:&#10;SN001&#10;SN002&#10;SN003" rows="4"
                                   class="scanner-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg"></textarea>
                            <p class="text-sm text-gray-500 mt-1">üí° ‡πÉ‡∏™‡πà Serial Number ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏∏‡∏•‡∏†‡∏≤‡∏Ñ</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üì± ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                            <select id="receive-product" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
                                <option value="‡∏Å‡∏•‡πâ‡∏≠‡∏á CCTV">‡∏Å‡∏•‡πâ‡∏≠‡∏á CCTV</option>
                                <option value="SIM">SIM</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 px-6 rounded-lg font-medium transition-colors">
                        ‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤
                    </button>
                </form>
            </div>
        </div>

        <!-- Issue Tab -->
        <div id="issue-tab" class="hidden">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">üì§ ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                <form onsubmit="issueItem(event)" class="space-y-4">
                    <div class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üîç ‡πÅ‡∏™‡∏Å‡∏ô/‡πÉ‡∏™‡πà Serial Number (‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß)</label>
                            <textarea id="issue-sn" placeholder="‡πÅ‡∏™‡∏Å‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå SN (‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏Ñ‡∏∑‡∏≠ SN ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß)&#10;‡πÄ‡∏ä‡πà‡∏ô:&#10;SN001&#10;SN002&#10;SN003" rows="4"
                                   class="scanner-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-lg"></textarea>
                            <p class="text-sm text-gray-500 mt-1">üí° ‡πÉ‡∏™‡πà Serial Number ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏∏‡∏•‡∏†‡∏≤‡∏Ñ</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üë®‚Äçüîß ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á</label>
                            <input type="text" id="issue-technician" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-3 px-6 rounded-lg font-medium transition-colors">
                        üì§ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢
                    </button>
                </form>
            </div>
        </div>

        <!-- Overview Tab -->
        <div id="overview-tab" class="hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            <p class="text-3xl font-bold" id="total-items">0</p>
                        </div>
                        <div class="text-4xl">üì¶</div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Ñ</p>
                            <p class="text-3xl font-bold" id="stock-items">0</p>
                        </div>
                        <div class="text-4xl">‚úÖ</div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-orange-100">‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
                            <p class="text-3xl font-bold" id="issued-items">0</p>
                        </div>
                        <div class="text-4xl">üì§</div>
                    </div>
                </div>
            </div>



            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                    <div class="flex gap-2">
                        <button onclick="exportToGoogleSheets()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            üìä ‡∏™‡πà‡∏á‡πÑ‡∏õ Google Sheets
                        </button>
                        <button onclick="showDeleteConfirmModal()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            üóëÔ∏è ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left font-medium text-gray-700">SN</th>
                                <th class="px-4 py-3 text-left font-medium text-gray-700">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                                <th class="px-4 py-3 text-left font-medium text-gray-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-3 text-left font-medium text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                            </tr>
                        </thead>
                        <tbody id="items-table" class="divide-y divide-gray-200">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Success/Error Messages -->
        <div id="message-container" class="fixed top-4 right-4 z-50"></div>
        
        <!-- Delete Confirmation Modal -->
        <div id="delete-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
            <div class="bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
                <div class="text-center mb-6">
                    <div class="text-6xl mb-4">‚ö†Ô∏è</div>
                    <h3 class="text-xl font-bold text-red-600 mb-2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                    <p class="text-gray-600">‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ</p>
                </div>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">üîê ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</label>
                    <input type="password" id="delete-password" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-center text-lg">
                    <p class="text-xs text-gray-500 mt-1">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                </div>
                
                <div class="flex gap-3">
                    <button onclick="hideDeleteConfirmModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                        ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button onclick="confirmDeleteAllData()" class="flex-1 bg-red-500 hover:bg-red-600 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                        üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage - ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        let inventory = [];
        let settings = {};
        let db;
        let cloudSyncEnabled = true;
        let lastSyncTime = 0;

        // Initialize IndexedDB
        async function initDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open('IoTInventoryDB', 1);
                
                request.onerror = () => reject(request.error);
                request.onsuccess = () => {
                    db = request.result;
                    resolve(db);
                };
                
                request.onupgradeneeded = (event) => {
                    db = event.target.result;
                    
                    // Create inventory store
                    if (!db.objectStoreNames.contains('inventory')) {
                        const inventoryStore = db.createObjectStore('inventory', { keyPath: 'id' });
                        inventoryStore.createIndex('sn', 'sn', { unique: true });
                        inventoryStore.createIndex('status', 'status', { unique: false });
                    }
                    
                    // Create settings store
                    if (!db.objectStoreNames.contains('settings')) {
                        db.createObjectStore('settings', { keyPath: 'key' });
                    }
                };
            });
        }

        // Load data from IndexedDB
        async function loadData() {
            try {
                // Load inventory
                const inventoryData = await getAllFromStore('inventory');
                inventory = inventoryData || [];
                
                // Load settings
                const settingsData = await getAllFromStore('settings');
                settings = {};
                settingsData.forEach(item => {
                    settings[item.key] = item.value;
                });
                
                // Fallback to localStorage if IndexedDB is empty
                if (inventory.length === 0) {
                    const localInventory = localStorage.getItem('iot-inventory');
                    if (localInventory) {
                        inventory = JSON.parse(localInventory);
                        await saveInventory(); // Migrate to IndexedDB
                    }
                }
                
                if (Object.keys(settings).length === 0) {
                    const localSettings = localStorage.getItem('iot-settings');
                    if (localSettings) {
                        settings = JSON.parse(localSettings);
                        await saveSettings(); // Migrate to IndexedDB
                    }
                }
                
            } catch (error) {
                console.error('Error loading data:', error);
                // Fallback to localStorage
                inventory = JSON.parse(localStorage.getItem('iot-inventory') || '[]');
                settings = JSON.parse(localStorage.getItem('iot-settings') || '{}');
            }
        }

        // Get all data from a store
        function getAllFromStore(storeName) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readonly');
                const store = transaction.objectStore(storeName);
                const request = store.getAll();
                
                request.onsuccess = () => resolve(request.result);
                request.onerror = () => reject(request.error);
            });
        }

        // Save data to IndexedDB store
        function saveToStore(storeName, data) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const store = transaction.objectStore(storeName);
                const request = store.put(data);
                
                request.onsuccess = () => resolve(request.result);
                request.onerror = () => reject(request.error);
            });
        }

        // Clear store
        function clearStore(storeName) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const store = transaction.objectStore(storeName);
                const request = store.clear();
                
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // Cloud sync functions
        async function syncToCloud() {
            if (!cloudSyncEnabled) return;
            
            try {
                const cloudData = {
                    inventory: inventory,
                    settings: settings,
                    timestamp: Date.now(),
                    version: '1.0'
                };
                
                // ‡πÉ‡∏ä‡πâ localStorage ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏à‡∏≥‡∏•‡∏≠‡∏á (‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô Firebase/Supabase)
                localStorage.setItem('iot-cloud-data', JSON.stringify(cloudData));
                localStorage.setItem('iot-cloud-sync-time', Date.now().toString());
                
                lastSyncTime = Date.now();
                console.log('Synced to cloud successfully');
                
            } catch (error) {
                console.error('Cloud sync failed:', error);
            }
        }
        
        async function syncFromCloud() {
            if (!cloudSyncEnabled) return false;
            
            try {
                const cloudDataStr = localStorage.getItem('iot-cloud-data');
                const cloudSyncTime = parseInt(localStorage.getItem('iot-cloud-sync-time') || '0');
                
                if (!cloudDataStr || cloudSyncTime <= lastSyncTime) {
                    return false; // No new data
                }
                
                const cloudData = JSON.parse(cloudDataStr);
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡πÉ‡∏´‡∏°‡πà‡∏Å‡∏ß‡πà‡∏≤
                if (cloudData.timestamp > lastSyncTime) {
                    inventory = cloudData.inventory || [];
                    settings = cloudData.settings || {};
                    lastSyncTime = cloudData.timestamp;
                    
                    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á IndexedDB
                    await saveInventory();
                    await saveSettings();
                    
                    console.log('Synced from cloud successfully');
                    return true;
                }
                
                return false;
                
            } catch (error) {
                console.error('Cloud sync from failed:', error);
                return false;
            }
        }
        
        // Update sync status
        function updateSyncStatus(status, isError = false) {
            const statusElement = document.getElementById('sync-status');
            if (statusElement) {
                const color = isError ? 'text-red-700' : 'text-blue-700';
                statusElement.className = `font-medium ${color}`;
                statusElement.innerHTML = `üîÑ <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${status}`;
            }
        }
        
        // Auto sync every 5 seconds
        setInterval(async () => {
            if (!cloudSyncEnabled) {
                updateSyncStatus('‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå');
                return;
            }
            
            try {
                updateSyncStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà...');
                const hasNewData = await syncFromCloud();
                if (hasNewData) {
                    updateOverview();
                    loadSettings();
                    updateSyncStatus('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úÖ');
                    showMessage('üîÑ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß', 'info');
                } else {
                    updateSyncStatus('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß ‚úÖ');
                }
            } catch (error) {
                updateSyncStatus('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå', true);
            }
        }, 5000);
        
        // Handle sync toggle
        document.addEventListener('DOMContentLoaded', function() {
            const syncToggle = document.getElementById('cloud-sync-toggle');
            if (syncToggle) {
                syncToggle.addEventListener('change', function() {
                    cloudSyncEnabled = this.checked;
                    if (cloudSyncEnabled) {
                        updateSyncStatus('‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÅ‡∏•‡πâ‡∏ß');
                        syncToCloud(); // Sync immediately when enabled
                    } else {
                        updateSyncStatus('‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå');
                    }
                });
            }
        });
        
        // Initialize
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                await initDB();
                
                // ‡∏•‡∏≠‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏Å‡πà‡∏≠‡∏ô
                const hasCloudData = await syncFromCloud();
                if (!hasCloudData) {
                    await loadData(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå
                }
                
                updateOverview();
                loadSettings();
                
                // ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÑ‡∏õ‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå
                await syncToCloud();
                
                showMessage('üåê ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô - ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô', 'success');
                updateSyncStatus('‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô - ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‚úÖ');
                
            } catch (error) {
                console.error('Initialization error:', error);
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏≠‡∏á', 'error');
                await loadData();
                updateOverview();
                loadSettings();
            }
        });

        // Tab management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('[id$="-tab"]').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active state from all tab buttons
            document.querySelectorAll('[id^="tab-"]').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600', 'bg-blue-50');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.remove('hidden');
            
            // Add active state to selected tab button
            const activeBtn = document.getElementById('tab-' + tabName);
            activeBtn.classList.add('border-blue-500', 'text-blue-600', 'bg-blue-50');
            activeBtn.classList.remove('border-transparent', 'text-gray-500');
        }

        // Receive item
        function receiveItem(event) {
            event.preventDefault();
            
            const snInput = document.getElementById('receive-sn').value.trim();
            const product = document.getElementById('receive-product').value;
            const price = 0; // ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏Ñ‡∏≤
            const quantity = 1;
            const note = '';
            
            if (!snInput || !product) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Serial Number ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤', 'error');
                return;
            }
            
            // Parse multiple SNs - split by newlines or commas
            const snList = snInput.split(/[\n,]/)
                .map(sn => sn.trim())
                .filter(sn => sn.length > 0);
            
            if (snList.length === 0) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Serial Number', 'error');
                return;
            }
            
            let successCount = 0;
            let duplicateCount = 0;
            let duplicateSNs = [];
            
            // Process each SN
            snList.forEach((sn, index) => {
                // Check if SN already exists
                const existingItem = inventory.find(item => item.sn === sn);
                if (existingItem) {
                    duplicateCount++;
                    duplicateSNs.push(sn);
                    return;
                }
                
                // Add to inventory
                const newItem = {
                    id: Date.now() + index, // Ensure unique IDs
                    sn: sn,
                    product: product,
                    price: price,
                    quantity: quantity,
                    status: 'in-stock',
                    receivedDate: new Date().toISOString(),
                    receivedBy: 'System',
                    note: note
                };
                
                inventory.push(newItem);
                successCount++;
                
                // Auto-sync to Google Sheets
                if (settings.autoSync) {
                    autoSyncToSheets('receive', newItem);
                }
            });
            
            saveInventory();
            
            // Show results
            if (successCount > 0) {
                showMessage(`‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${successCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: ${product}`, 'success');
            }
            
            if (duplicateCount > 0) {
                showMessage(`‡∏û‡∏ö SN ‡∏ã‡πâ‡∏≥ ${duplicateCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: ${duplicateSNs.slice(0, 3).join(', ')}${duplicateSNs.length > 3 ? '...' : ''}`, 'error');
            }
            
            if (successCount === 0 && duplicateCount > 0) {
                showMessage('‡πÑ‡∏°‡πà‡∏°‡∏µ SN ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ', 'error');
                return;
            }
            
            // Clear form
            document.getElementById('receive-sn').value = '';
            document.getElementById('receive-product').value = '';
            
            updateOverview();
            
            // Focus back to SN input for continuous scanning
            document.getElementById('receive-sn').focus();
        }

        // Issue item
        function issueItem(event) {
            event.preventDefault();
            
            const snInput = document.getElementById('issue-sn').value.trim();
            const technician = document.getElementById('issue-technician').value.trim();
            const quantity = 1;
            
            if (!snInput || !technician) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Serial Number ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á', 'error');
                return;
            }
            
            // Parse multiple SNs - split by newlines or commas
            const snList = snInput.split(/[\n,]/)
                .map(sn => sn.trim())
                .filter(sn => sn.length > 0);
            
            if (snList.length === 0) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Serial Number', 'error');
                return;
            }
            
            let successCount = 0;
            let notFoundCount = 0;
            let insufficientCount = 0;
            let notFoundSNs = [];
            let insufficientSNs = [];
            let issuedItems = [];
            
            // Process each SN
            snList.forEach(sn => {
                // Find item in inventory
                const itemIndex = inventory.findIndex(item => item.sn === sn && item.status === 'in-stock');
                if (itemIndex === -1) {
                    notFoundCount++;
                    notFoundSNs.push(sn);
                    return;
                }
                
                const item = inventory[itemIndex];
                if (item.quantity < quantity) {
                    insufficientCount++;
                    insufficientSNs.push(`${sn} (‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${item.quantity})`);
                    return;
                }
                
                // Update item status
                if (item.quantity === quantity) {
                    item.status = 'issued';
                    item.quantity = 0;
                } else {
                    item.quantity -= quantity;
                }
                
                item.issuedDate = new Date().toISOString();
                item.issuedTo = technician;
                item.issuedQuantity = quantity;
                
                issuedItems.push(item);
                successCount++;
                
                // Auto-sync to Google Sheets
                if (settings.autoSync) {
                    autoSyncToSheets('issue', item);
                }
            });
            
            saveInventory();
            
            // Show results
            if (successCount > 0) {
                const productList = [...new Set(issuedItems.map(item => item.product))].join(', ');
                showMessage(`‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${successCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: ${productList} ‡πÉ‡∏´‡πâ ${technician}`, 'success');
            }
            
            if (notFoundCount > 0) {
                showMessage(`‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Ñ ${notFoundCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: ${notFoundSNs.slice(0, 3).join(', ')}${notFoundSNs.length > 3 ? '...' : ''}`, 'error');
            }
            
            if (insufficientCount > 0) {
                showMessage(`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ${insufficientCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: ${insufficientSNs.slice(0, 2).join(', ')}${insufficientSNs.length > 2 ? '...' : ''}`, 'error');
            }
            
            if (successCount === 0) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏î‡πÑ‡∏î‡πâ', 'error');
                return;
            }
            
            // Clear form
            document.getElementById('issue-sn').value = '';
            document.getElementById('issue-technician').value = '';
            
            updateOverview();
            
            // Focus back to SN input for continuous scanning
            document.getElementById('issue-sn').focus();
        }

        // Update overview
        function updateOverview() {
            const totalItems = inventory.length;
            const stockItems = inventory.filter(item => item.status === 'in-stock').length;
            const issuedItems = inventory.filter(item => item.status === 'issued').length;
            
            document.getElementById('total-items').textContent = totalItems;
            document.getElementById('stock-items').textContent = stockItems;
            document.getElementById('issued-items').textContent = issuedItems;
            
            updateItemsTable();
        }

        // Update items table
        function updateItemsTable() {
            const tbody = document.getElementById('items-table');
            tbody.innerHTML = '';
            
            const recentItems = inventory.slice(-10).reverse();
            
            recentItems.forEach(item => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                const statusBadge = item.status === 'in-stock' 
                    ? '<span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</span>'
                    : '<span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß</span>';
                
                const date = new Date(item.receivedDate).toLocaleDateString('th-TH');
                
                row.innerHTML = `
                    <td class="px-4 py-3 font-mono text-sm">${item.sn}</td>
                    <td class="px-4 py-3">${item.product}</td>
                    <td class="px-4 py-3">${statusBadge}</td>
                    <td class="px-4 py-3">${date}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Save inventory to IndexedDB and sync to cloud
        async function saveInventory() {
            try {
                // Clear existing data
                await clearStore('inventory');
                
                // Save all inventory items
                for (const item of inventory) {
                    await saveToStore('inventory', item);
                }
                
                // Also save to localStorage as backup
                localStorage.setItem('iot-inventory', JSON.stringify(inventory));
                
                // Sync to cloud
                await syncToCloud();
                
            } catch (error) {
                console.error('Error saving inventory:', error);
                // Fallback to localStorage only
                localStorage.setItem('iot-inventory', JSON.stringify(inventory));
                await syncToCloud(); // Still try to sync
            }
        }

        // Save settings to IndexedDB and sync to cloud
        async function saveSettings() {
            try {
                // Clear existing settings
                await clearStore('settings');
                
                // Save all settings
                for (const [key, value] of Object.entries(settings)) {
                    await saveToStore('settings', { key, value });
                }
                
                // Also save to localStorage as backup
                localStorage.setItem('iot-settings', JSON.stringify(settings));
                
                // Sync to cloud
                await syncToCloud();
                
            } catch (error) {
                console.error('Error saving settings:', error);
                // Fallback to localStorage only
                localStorage.setItem('iot-settings', JSON.stringify(settings));
                await syncToCloud(); // Still try to sync
            }
        }

        // Load settings
        function loadSettings() {
            if (settings.sheetsUrl) {
                document.getElementById('sheets-url').value = settings.sheetsUrl;
            }
            if (settings.apiKey) {
                document.getElementById('api-key').value = settings.apiKey;
            }
            if (settings.autoSync) {
                document.getElementById('auto-sync').checked = settings.autoSync;
            }
        }

        // Test connection
        async function testConnection() {
            const sheetsUrl = document.getElementById('sheets-url').value.trim();
            const apiKey = document.getElementById('api-key').value.trim();
            const autoSync = document.getElementById('auto-sync').checked;
            
            if (!sheetsUrl) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Google Apps Script URL', 'error');
                return;
            }
            
            // Validate URL format
            if (!sheetsUrl.includes('script.google.com') || !sheetsUrl.includes('/exec')) {
                showMessage('URL ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô Google Apps Script Web App URL ‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ /exec', 'error');
                return;
            }
            
            // Save settings
            settings.sheetsUrl = sheetsUrl;
            settings.apiKey = apiKey;
            settings.autoSync = autoSync;
            await saveSettings();
            
            // Test actual connection
            try {
                showMessage('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...', 'info');
                
                // Try both POST and GET methods
                let response;
                try {
                    // First try POST
                    response = await fetch(sheetsUrl, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            action: 'test',
                            timestamp: new Date().toISOString()
                        })
                    });
                } catch (postError) {
                    // If POST fails, try GET
                    response = await fetch(sheetsUrl + '?action=test', {
                        method: 'GET',
                        mode: 'no-cors'
                    });
                }
                
                // Since we're using no-cors, we can't read the response
                // But if no error is thrown, the URL is likely valid
                showMessage('‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Apps Script ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                showMessage('‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏î "‡∏™‡πà‡∏á‡πÑ‡∏õ Google Sheets"', 'info');
                
            } catch (error) {
                console.error('Connection test failed:', error);
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ', 'error');
                showMessage('‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: 1) URL ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á 2) Deploy ‡πÄ‡∏õ‡πá‡∏ô Web App 3) Access = Anyone', 'info');
            }
        }

        // Export to Google Sheets
        async function exportToGoogleSheets() {
            if (!settings.sheetsUrl) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Apps Script URL ‡∏Å‡πà‡∏≠‡∏ô', 'error');
                showTab('settings');
                return;
            }
            
            if (inventory.length === 0) {
                showMessage('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á', 'error');
                return;
            }
            
            // Prepare data for export
            const exportData = inventory.map(item => ({
                'Serial Number': item.sn,
                '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤': item.product,
                '‡∏£‡∏≤‡∏Ñ‡∏≤': item.price,
                '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô': item.quantity,
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': item.status === 'in-stock' ? '‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠' : '‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß',
                '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö': new Date(item.receivedDate).toLocaleDateString('th-TH'),
                '‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å': item.issuedTo || '-',
                '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': item.note || '-',
                '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å': item.issuedDate ? new Date(item.issuedDate).toLocaleDateString('th-TH') : '-'
            }));
            
            showMessage(`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${exportData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏õ Google Sheets...`, 'info');
            
            try {
                // Use no-cors mode to avoid CORS issues
                const response = await fetch(settings.sheetsUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'updateInventory',
                        data: exportData,
                        timestamp: new Date().toISOString()
                    })
                });
                
                // With no-cors, we can't read the response, but if no error is thrown,
                // the request was likely successful
                showMessage('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                showMessage('‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì', 'info');
                
            } catch (error) {
                console.error('Export error:', error);
                
                // Try alternative method with form data
                try {
                    const formData = new FormData();
                    formData.append('data', JSON.stringify({
                        action: 'updateInventory',
                        data: exportData,
                        timestamp: new Date().toISOString()
                    }));
                    
                    await fetch(settings.sheetsUrl, {
                        method: 'POST',
                        mode: 'no-cors',
                        body: formData
                    });
                    
                    showMessage('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! (‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏≥‡∏£‡∏≠‡∏á)', 'success');
                } catch (secondError) {
                    showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Apps Script', 'error');
                    showMessage('‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: 1) URL ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á 2) Deploy ‡πÄ‡∏õ‡πá‡∏ô Web App 3) Access = Anyone', 'info');
                }
            }
        }

        // Auto-sync to Google Sheets when items are added/updated
        async function autoSyncToSheets(action, itemData) {
            if (!settings.sheetsUrl || !settings.autoSync) return;
            
            try {
                await fetch(settings.sheetsUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: action, // 'receive' or 'issue'
                        data: itemData,
                        timestamp: new Date().toISOString()
                    })
                });
            } catch (error) {
                console.log('Auto-sync failed:', error);
            }
        }

        // Show message
        function showMessage(text, type = 'info') {
            const container = document.getElementById('message-container');
            const message = document.createElement('div');
            
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500'
            };
            
            message.className = `${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg mb-2 fade-in`;
            message.textContent = text;
            
            container.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 5000);
        }

        // Show delete confirmation modal
        function showDeleteConfirmModal() {
            document.getElementById('delete-modal').classList.remove('hidden');
            document.getElementById('delete-password').value = '';
            document.getElementById('delete-password').focus();
        }
        
        // Hide delete confirmation modal
        function hideDeleteConfirmModal() {
            document.getElementById('delete-modal').classList.add('hidden');
            document.getElementById('delete-password').value = '';
        }
        
        // Confirm delete with password
        async function confirmDeleteAllData() {
            const password = document.getElementById('delete-password').value;
            const correctPassword = 'John19195';
            
            if (password !== correctPassword) {
                showMessage('üîê ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
                document.getElementById('delete-password').value = '';
                document.getElementById('delete-password').focus();
                return;
            }
            
            hideDeleteConfirmModal();
            
            try {
                // Clear IndexedDB
                await clearStore('inventory');
                await clearStore('settings');
                
                // Clear localStorage
                localStorage.removeItem('iot-inventory');
                localStorage.removeItem('iot-settings');
                localStorage.removeItem('iot-cloud-data');
                localStorage.removeItem('iot-cloud-sync-time');
                
                // Reset variables
                inventory = [];
                settings = {};
                lastSyncTime = 0;
                
                // Update UI
                updateOverview();
                document.getElementById('sheets-url').value = '';
                document.getElementById('api-key').value = '';
                document.getElementById('auto-sync').checked = false;
                
                // Sync empty data to cloud
                await syncToCloud();
                
                showMessage('üóëÔ∏è ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
                showMessage('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ä‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß', 'info');
                
            } catch (error) {
                console.error('Error clearing data:', error);
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
            }
        }

        // Clear all data (legacy function for settings page)
        async function clearAllData() {
            if (!confirm('‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?\n\n‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ!')) {
                return;
            }
            
            if (!confirm('üö® ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á: ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')) {
                return;
            }
            
            try {
                // Clear IndexedDB
                await clearStore('inventory');
                await clearStore('settings');
                
                // Clear localStorage
                localStorage.removeItem('iot-inventory');
                localStorage.removeItem('iot-settings');
                localStorage.removeItem('iot-cloud-data');
                localStorage.removeItem('iot-cloud-sync-time');
                
                // Reset variables
                inventory = [];
                settings = {};
                lastSyncTime = 0;
                
                // Update UI
                updateOverview();
                document.getElementById('sheets-url').value = '';
                document.getElementById('api-key').value = '';
                document.getElementById('auto-sync').checked = false;
                
                // Sync empty data to cloud
                await syncToCloud();
                
                showMessage('‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
                
            } catch (error) {
                console.error('Error clearing data:', error);
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
            }
        }

        // Auto-focus on SN inputs when tabs are shown
        document.getElementById('tab-receive').addEventListener('click', () => {
            setTimeout(() => document.getElementById('receive-sn').focus(), 100);
        });
        
        document.getElementById('tab-issue').addEventListener('click', () => {
            setTimeout(() => document.getElementById('issue-sn').focus(), 100);
        });
        
        // Handle Enter key in delete password field
        document.addEventListener('DOMContentLoaded', function() {
            const deletePasswordField = document.getElementById('delete-password');
            if (deletePasswordField) {
                deletePasswordField.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        confirmDeleteAllData();
                    }
                });
            }
            
            // Close modal when clicking outside
            const deleteModal = document.getElementById('delete-modal');
            if (deleteModal) {
                deleteModal.addEventListener('click', function(e) {
                    if (e.target === deleteModal) {
                        hideDeleteConfirmModal();
                    }
                });
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'988a550b62f94b9b',t:'MTc1OTQ3MjQxMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
