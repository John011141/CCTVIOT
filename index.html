<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Store Manager Pro)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom Styles & Animation */
        body { box-sizing: border-box; }
        .page { display: none; }
        .page.active { display: block; }
        .nav-item.active { background-color: #3b82f6; color: white; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            padding: 24px;
            margin-bottom: 24px;
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° Category */
        .category-button {
            transition: all 0.2s;
            white-space: nowrap;
        }
        .category-button.selected {
            background-color: #10b981; /* emerald-500 */
            color: white;
            box-shadow: 0 2px 4px rgba(16, 185, 129, 0.5);
            border-color: #10b981;
        }

        /* Toast Notifications */
        #toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        .toast {
            animation: slideIn 0.3s ease-out, fadeOut 0.5s ease-in 3s forwards;
            min-width: 250px;
            max-width: 350px;
            margin-top: 10px;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* Print Styles */
        @media print {
            body > *:not(.container) { display: none; }
            .container { margin: 0; padding: 0; width: 100%; max-width: none; background: white; }
            #inventory { display: block !important; }
            .page { display: block !important; }
            .card { box-shadow: none; border: 1px solid #ccc; }
            #inventory .flex.justify-between.items-center.mb-6 { display: none; }
            #inventoryPagination { display: none; }
            table { font-size: 9pt; width: 100%; border-collapse: collapse; }
            th, td { padding: 4px 6px; border: 1px solid #ddd; }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-full font-sans">
    
    <div id="toast-container"></div>

    <script>
        // WEB_APP_URL ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Local Storage ‡πÉ‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô loadSettings()
        const DEFAULT_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxgEUYIySWgu7hKF424sn4HaNcXy9lMhdPIqXNF5-qZSdGVFjCT8yLtz5_5d5M2pZtt/exec"; 
    </script>

    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-6">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-2">
                    <div class="text-2xl text-blue-600">üì¶</div>
                    <h1 class="text-xl font-extrabold text-gray-800">STORE MANAGER PRO</h1>
                </div>
                
                <div class="flex space-x-1 text-sm">
                    <button onclick="showPage('dashboard')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-dashboard">
                        üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
                    </button>
                    <button onclick="showPage('receive')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-receive">
                        üì• ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤
                    </button>
                    <button onclick="showPage('withdraw')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-withdraw">
                        üì§ ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢
                    </button>
                    <button onclick="showPage('inventory')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-inventory">
                        üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                    </button>
                    <button onclick="showPage('settings')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-settings">
                        ‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-6 py-8">
        <div id="dashboard" class="page active">
            <div class="card fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üìä ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                
                <div class="grid md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-blue-600 text-white p-6 rounded-xl shadow-lg">
                        <p class="text-blue-100">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                        <p class="text-4xl font-extrabold mt-1" id="dash-total">0</p>
                    </div>
                    <div class="bg-emerald-500 text-white p-6 rounded-xl shadow-lg">
                        <p class="text-emerald-100">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á</p>
                        <p class="text-4xl font-extrabold mt-1" id="dash-available">0</p>
                    </div>
                    <div class="bg-orange-500 text-white p-6 rounded-xl shadow-lg">
                        <p class="text-orange-100">‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
                        <p class="text-4xl font-extrabold mt-1" id="dash-withdrawn">0</p>
                    </div>
                    <div class="bg-gray-700 text-white p-6 rounded-xl shadow-lg">
                        <p class="text-gray-300">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                        <p class="text-4xl font-extrabold mt-1" id="dash-categories">0</p>
                    </div>
                </div>

                <div class="grid lg:grid-cols-2 gap-6">
                    <div class="bg-gray-50 p-6 rounded-xl">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800">üöÄ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
                        <div class="space-y-3">
                            <button onclick="showPage('receive')" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-xl transition-colors flex items-center justify-center space-x-2 font-medium">
                                <span>üì•</span>
                                <span>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á</span>
                            </button>
                            <button onclick="showPage('withdraw')" class="w-full bg-orange-600 hover:bg-orange-700 text-white py-3 px-4 rounded-xl transition-colors flex items-center justify-center space-x-2 font-medium">
                                <span>üì§</span>
                                <span>‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-xl">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800">üìà ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h3>
                        <div id="recentItems" class="space-y-2">
                            <p class="text-sm text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="receive" class="page">
            <div class="card fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üì• ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                
                <form onsubmit="addItems(event)" class="space-y-6">
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div>
                            <label for="serialNumbers" class="block text-lg font-semibold text-gray-700 mb-3">üìù Serial Numbers (SN)</label>
                            <textarea id="serialNumbers" rows="10" 
                                        placeholder="‡πÉ‡∏™‡πà Serial Number ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î&#10;&#10;‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:&#10;SN-PRT-001&#10;SN-PRT-002&#10;SN-PRT-003" 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-base" required></textarea>
                            <p class="text-sm text-gray-500 mt-2">üí° ‡πÉ‡∏™‡πà SN ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÅ‡∏¢‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</p>
                        </div>
                        
                        <div class="space-y-6">
                            
                            <div class="space-y-3">
                                <label class="block text-lg font-semibold text-gray-700 mb-3">üè∑Ô∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                                
                                <div id="categorySelection" class="flex flex-wrap gap-2 mb-4 p-3 bg-gray-50 rounded-lg border min-h-[50px]">
                                    <p class="text-sm text-gray-500 w-full">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà...</p>
                                </div>

                                <div class="flex items-center space-x-3">
                                    <input type="text" id="newCategoryInput" 
                                            placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà" 
                                            class="flex-grow px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <button type="button" onclick="addNewCategory()" 
                                            class="bg-gray-700 hover:bg-gray-800 text-white px-4 py-3 rounded-xl transition-colors font-medium text-sm whitespace-nowrap">
                                        + ‡πÄ‡∏û‡∏¥‡πà‡∏°
                                    </button>
                                </div>
                                <input type="hidden" id="selectedCategory" required data-validation-message="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà">
                            </div>
                            
                            <div class="bg-blue-50 p-4 rounded-xl border border-blue-200">
                                <h4 class="font-bold text-blue-800 mb-2 text-lg">üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</h4>
                                <p class="text-sm text-blue-600">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <span id="currentDate" class="font-medium"></span></p>
                                <p class="text-sm text-blue-600">üë§ ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤: ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-4 pt-4">
                        <button type="button" onclick="clearReceiveForm()" 
                                class="px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 transition-colors font-medium">
                            ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                        <button type="submit" id="receiveSubmitBtn"
                                class="px-8 py-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-xl transition-colors font-bold shadow-lg shadow-emerald-200 flex items-center justify-center space-x-2">
                            <span>‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á</span>
                            <i id="receiveSpinner" class="fas fa-circle-notch fa-spin hidden"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="withdraw" class="page">
            <div class="card fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üì§ ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                
                <form onsubmit="withdrawItems(event)" class="space-y-6">
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div>
                            <label for="withdrawSN" class="block text-lg font-semibold text-gray-700 mb-3">üîç Serial Numbers ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å</label>
                            <textarea id="withdrawSN" rows="8" 
                                        placeholder="‡πÉ‡∏™‡πà Serial Number ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å&#10;&#10;‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:&#10;SN-PRT-001&#10;SN-PRT-002" 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500 font-mono text-base" required></textarea>
                            <button type="button" onclick="checkAvailability()" 
                                        class="mt-2 text-sm text-orange-600 hover:text-orange-700 underline font-medium">
                                üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°
                            </button>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label for="technicianName" class="block text-lg font-semibold text-gray-700 mb-3">üë§ ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å / ‡∏ä‡πà‡∏≤‡∏á (ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)</label>
                                <input type="text" id="technicianName" 
                                            placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏´‡∏£‡∏∑‡∏≠ ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å" 
                                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500" required>
                            </div>
                            
                            <div class="bg-orange-50 p-4 rounded-xl border border-orange-200">
                                <h4 class="font-bold text-orange-800 mb-2 text-lg">üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å</h4>
                                <p class="text-sm text-orange-600">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å: <span id="withdrawDate" class="font-medium"></span></p>
                            </div>
                        </div>
                    </div>
                    
                    <div id="availabilityCheck" class="hidden bg-gray-50 p-4 rounded-xl border border-gray-300">
                        <h4 class="font-bold text-gray-800 mb-2">üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°</h4>
                        <div id="checkResults" class="space-y-1"></div>
                    </div>
                    
                    <div class="flex justify-end space-x-4 pt-4">
                        <button type="button" onclick="clearWithdrawForm()" 
                                class="px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 transition-colors font-medium">
                            ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                        <button type="submit" id="withdrawSubmitBtn"
                                class="px-8 py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-xl transition-colors font-bold shadow-lg shadow-orange-200 flex items-center justify-center space-x-2">
                            <span>‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢</span>
                            <i id="withdrawSpinner" class="fas fa-circle-notch fa-spin hidden"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="inventory" class="page">
            <div class="card fade-in">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                    <div class="flex space-x-3">
                        <button onclick="showAddItemModal()" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl text-sm transition-colors flex items-center space-x-1 font-medium shadow-md">
                            <span>‚ûï</span>
                            <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</span>
                        </button>
                        <select id="statusFilter" onchange="filterInventory()" 
                                class="px-4 py-2 border border-gray-300 rounded-xl text-sm">
                            <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                            <option value="Available">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</option>
                            <option value="Withdrawn">‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß</option>
                        </select>
                        <input type="text" id="searchSN" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ SN ‡∏´‡∏£‡∏∑‡∏≠ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà..." 
                               onkeyup="filterInventory()"
                               class="px-4 py-2 border border-gray-300 rounded-xl text-sm w-56">
                    </div>
                </div>
                
                <div class="overflow-x-auto rounded-lg border">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gray-50 border-b border-gray-200">
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[20%]">Serial Number</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[20%]">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[10%]">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[10%]">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[20%]">‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å (ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[10%]">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å</th>
                                <th class="px-4 py-3 text-center font-semibold text-gray-700 w-[10%]">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryTable">
                            <tr id="empty-inventory-row" class="text-center"><td colspan="7" class="py-4 text-gray-500">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î/‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div id="inventoryPagination" class="mt-6 flex justify-center">
                    </div>
            </div>
        </div>

        <div id="settings" class="page">
            <div class="space-y-8 fade-in">
                
                <div class="card border-t-4 border-blue-600">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">‚òÅÔ∏è Google Sheets Sync (Apps Script)</h2>
                    <p class="text-sm text-gray-600 mb-4">
                        ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ **Google Apps Script Web App URL** ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á <br>
                        *‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ä‡∏µ‡∏ó '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤' ‡πÅ‡∏•‡∏∞ '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢' ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£*
                    </p>

                    <div class="space-y-4">
                        <div>
                            <label for="webAppUrl" class="block text-sm font-medium text-gray-700 mb-2">Google Apps Script Web App URL</label>
                            <input type="url" id="webAppUrl" placeholder="‡πÉ‡∏™‡πà URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy Apps Script" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm" required>
                        </div>
                        <div id="connectionStatus" class="text-sm font-medium">
                            <span class="text-gray-500">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL</span>
                        </div>
                    </div>
                    
                    <div class="flex space-x-4 mt-6">
                        <button onclick="saveWebAppUrl()" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-xl transition-colors font-medium shadow-md">
                            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL
                        </button>
                        <button onclick="testGoogleSheetsConnection()" 
                                class="bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-2 rounded-xl transition-colors font-medium shadow-md">
                            üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                        </button>
                    </div>
                </div>

                <div class="card border-t-4 border-gray-700">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üóÇÔ∏è ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                    <div class="grid md:grid-cols-3 gap-4">
                        <button onclick="exportToCSV()" 
                                class="bg-gray-700 hover:bg-gray-800 text-white px-6 py-3 rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                            <span>üìä</span>
                            <span>‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</span>
                        </button>
                        <button onclick="backupData()" 
                                class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                            <span>üíæ</span>
                            <span>‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (JSON)</span>
                        </button>
                        <button onclick="clearAllData()" 
                                class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                            <span>üóëÔ∏è</span>
                            <span>‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                        </button>
                    </div>
                </div>

                <div class="card border-t-4 border-indigo-600">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h2>
                    <button onclick="printReport()" 
                            class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-xl transition-colors font-medium flex items-center justify-center space-x-2 w-full md:w-auto">
                        <span>üñ®Ô∏è</span>
                        <span>‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="addItemModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md mx-auto shadow-2xl">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (1 ‡∏ä‡∏¥‡πâ‡∏ô)</h3>
                <button type="button" onclick="hideAddItemModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <form onsubmit="addSingleItem(event)" class="space-y-4">
                <div>
                    <label for="modalSN" class="block text-sm font-medium text-gray-700 mb-2">üìù Serial Number</label>
                    <input type="text" id="modalSN" placeholder="‡πÉ‡∏™‡πà Serial Number" 
                            class="w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">üè∑Ô∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                    <div id="modalCategorySelection" class="flex flex-wrap gap-2 p-3 bg-gray-50 rounded-lg border min-h-[50px]">
                        <p class="text-sm text-gray-500 w-full">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà...</p>
                    </div>
                    <input type="hidden" id="modalSelectedCategory" required data-validation-message="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà">
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="hideAddItemModal()" 
                            class="px-5 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 transition-colors font-medium">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button type="submit" id="modalSubmitBtn"
                            class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                        <span>‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                        <i id="modalSpinner" class="fas fa-circle-notch fa-spin hidden"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="editItemModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md mx-auto shadow-2xl">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                <button type="button" onclick="hideEditItemModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <form onsubmit="saveEditItem(event)" class="space-y-4">
                <div>
                    <label for="editSN" class="block text-sm font-medium text-gray-700 mb-2">üìù Serial Number</label>
                    <input type="text" id="editSN" class="w-full px-4 py-2 border border-gray-300 rounded-xl bg-gray-100 text-gray-600" readonly>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">üè∑Ô∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                    <div id="editCategorySelection" class="flex flex-wrap gap-2 p-3 bg-gray-50 rounded-lg border min-h-[50px]"></div>
                    <input type="hidden" id="editSelectedCategory" required data-validation-message="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà">
                </div>

                <div>
                    <label for="editTechnician" class="block text-sm font-medium text-gray-700 mb-2">üë§ ‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß)</label>
                    <input type="text" id="editTechnician" placeholder="‡∏ä‡∏∑‡πà‡∏≠/ID ‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="hideEditItemModal()" 
                            class="px-5 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 transition-colors font-medium">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button type="submit" id="editSubmitBtn"
                            class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                        <span>üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</span>
                        <i id="editSpinner" class="fas fa-circle-notch fa-spin hidden"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>


    <script>
        // =============================================================
        // 1. ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        // =============================================================

        let inventory = JSON.parse(localStorage.getItem('storeInventory')) || [];
        let categories = JSON.parse(localStorage.getItem('storeCategories')) || []; // <--- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß
        let settings = JSON.parse(localStorage.getItem('storeSettings')) || { webAppUrl: DEFAULT_WEB_APP_URL };
        let currentPage = 'dashboard';
        const ITEMS_PER_PAGE = 10;
        let currentInventoryPage = 1;

        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            showPage('dashboard');
            updateAllDisplays();
            updateDateTime();
            setInterval(updateDateTime, 1000); 
        });

        function loadSettings() {
            if (settings.webAppUrl) {
                document.getElementById('webAppUrl').value = settings.webAppUrl;
                updateConnectionStatus('active', '‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ URL ‡πÅ‡∏•‡πâ‡∏ß');
            } else {
                document.getElementById('webAppUrl').value = '';
                updateConnectionStatus('inactive', '‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ URL Apps Script');
            }
        }
        
        function updateConnectionStatus(type, message) {
            const statusEl = document.getElementById('connectionStatus');
            let color = 'gray';
            if (type === 'active') color = 'green';
            else if (type === 'error') color = 'red';
            else if (type === 'test-success') color = 'blue';
            else if (type === 'test-fail') color = 'red';

            statusEl.innerHTML = `<span class="text-${color}-600">${message}</span>`;
        }

        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            
            let bgColor = 'bg-emerald-500';
            let icon = '<i class="fas fa-check-circle"></i>';
            if (type === 'error') {
                bgColor = 'bg-red-500';
                icon = '<i class="fas fa-times-circle"></i>';
            } else if (type === 'warning') {
                bgColor = 'bg-orange-500';
                icon = '<i class="fas fa-exclamation-triangle"></i>';
            } else if (type === 'info') {
                 bgColor = 'bg-blue-500';
                icon = '<i class="fas fa-info-circle"></i>';
            }

            toast.className = `toast ${bgColor} text-white p-4 rounded-xl shadow-lg flex items-center space-x-3`;
            toast.innerHTML = `${icon} <span>${message}</span>`;
            
            container.prepend(toast); // ‡πÉ‡∏™‡πà‡πÑ‡∏ß‡πâ‡∏ö‡∏ô‡∏™‡∏∏‡∏î
            
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 500); // ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å DOM ‡∏´‡∏•‡∏±‡∏á Animation
            }, 4000); 
        }

        // =============================================================
        // 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Local Storage & Sync)
        // =============================================================
        
        function saveInventory() {
            localStorage.setItem('storeInventory', JSON.stringify(inventory));
            updateAllDisplays(); 
        }

        function saveCategories() {
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö
            categories = [...new Set(categories)].sort(); 
            localStorage.setItem('storeCategories', JSON.stringify(categories));
            updateAllDisplays(); 
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Apps Script
        async function fetchData(action, payload) {
            const url = settings.webAppUrl;
            if (!url) {
                showToast('‚ùå ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Apps Script URL', 'error');
                return { success: false, message: 'Apps Script URL not set.' };
            }
            
            // payload ‡∏Ñ‡∏∑‡∏≠ Object ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏ß‡∏° action ‡πÅ‡∏•‡∏∞ data
            const params = { action: action, data: JSON.stringify(payload) };
            
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    mode: 'cors',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: new URLSearchParams(params).toString()
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast(`‚òÅÔ∏è ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${action} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`, 'info');
                    return { success: true, message: result.message };
                } else {
                    showToast(`‚ö†Ô∏è ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${action} ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${result.message}`, 'warning');
                    return { success: false, message: result.message };
                }

            } catch (error) {
                console.error('Error syncing with Apps Script:', error);
                showToast(`üö® ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Apps Script: ${error.message}`, 'error');
                return { success: false, message: error.message };
            }
        }

        // =============================================================
        // 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤ UI & General
        // =============================================================

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active', 'fade-in'));
            document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
            
            const activePage = document.getElementById(pageId);
            const activeNav = document.getElementById('nav-' + pageId);
            
            if (activePage) activePage.classList.add('active', 'fade-in');
            if (activeNav) activeNav.classList.add('active');
            
            currentPage = pageId;
            
            if (pageId === 'inventory') {
                currentInventoryPage = 1;
                updateInventoryDisplay();
            } else if (pageId === 'receive') {
                renderCategoryButtons('categorySelection', 'selectedCategory');
            } else if (pageId === 'dashboard') {
                updateDashboard();
            }
        }

        function updateAllDisplays() {
            updateDashboard();
            updateRecentItems();
            renderCategoryButtons('categorySelection', 'selectedCategory'); 
            renderCategoryButtons('modalCategorySelection', 'modalSelectedCategory');
            // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å updateInventoryDisplay() ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ô showPage('inventory')
        }

        function updateDateTime() {
            const now = new Date();
            // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö dd/mm/yyyy
            const dateStr = now.toLocaleDateString('th-TH', { year: 'numeric', month: '2-digit', day: '2-digit' }); 
            // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö YYYY-MM-DD ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö log/sheets
            const dateLogFormat = now.toISOString().split('T')[0]; 
            
            const currentDateEl = document.getElementById('currentDate');
            const withdrawDateEl = document.getElementById('withdrawDate');
            
            if (currentDateEl) currentDateEl.textContent = dateStr;
            if (withdrawDateEl) withdrawDateEl.textContent = dateStr;
            return dateLogFormat; 
        }
        
        function clearReceiveForm() {
            document.getElementById('serialNumbers').value = '';
            document.getElementById('newCategoryInput').value = '';
            document.getElementById('selectedCategory').value = '';
            
            document.querySelectorAll('#categorySelection .category-button').forEach(btn => {
                btn.classList.remove('selected', 'bg-emerald-500', 'text-white');
                btn.classList.add('border-emerald-500', 'text-emerald-600', 'hover:bg-emerald-50');
            });
        }
        
        function clearWithdrawForm() {
            document.getElementById('withdrawSN').value = '';
            document.getElementById('technicianName').value = '';
            document.getElementById('availabilityCheck').classList.add('hidden');
            document.getElementById('checkResults').innerHTML = '';
        }

        // =============================================================
        // 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (Category)
        // =============================================================
        
        function renderCategoryButtons(containerId, inputId, currentCategory = '') {
            const container = document.getElementById(containerId);
            const input = document.getElementById(inputId);
            container.innerHTML = '';
            
            if (categories.length === 0) {
                 container.innerHTML = `<p class="text-sm text-gray-500 w-full">‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</p>`;
                 return;
            }
            
            // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å input.value ‡∏´‡∏£‡∏∑‡∏≠ currentCategory ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏°‡∏≤
            const selectedCat = currentCategory || input.value;

            categories.forEach(cat => {
                const button = document.createElement('button');
                button.type = 'button';
                button.textContent = cat;
                
                let isSelected = cat === selectedCat;
                
                button.className = `category-button px-3 py-1 rounded-full text-sm border transition-colors ${
                    isSelected 
                        ? 'selected bg-emerald-500 text-white border-emerald-500' 
                        : 'border-emerald-500 text-emerald-600 hover:bg-emerald-50'
                }`;
                button.setAttribute('data-category', cat);
                
                button.onclick = () => {
                    // ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô container ‡∏ô‡∏µ‡πâ
                    container.querySelectorAll('.category-button').forEach(btn => {
                        btn.classList.remove('selected', 'bg-emerald-500', 'text-white', 'border-emerald-500');
                        btn.classList.add('border-emerald-500', 'text-emerald-600', 'hover:bg-emerald-50');
                    });
                    
                    // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                    button.classList.add('selected', 'bg-emerald-500', 'text-white', 'border-emerald-500');
                    button.classList.remove('text-emerald-600', 'hover:bg-emerald-50');
                    
                    input.value = cat; 
                };
                container.appendChild(button);
            });
            
            // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ selectedCat ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ input ‡πÅ‡∏•‡∏∞‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡∏õ‡∏∏‡πà‡∏°
            if (selectedCat) {
                 input.value = selectedCat;
            } else {
                input.value = '';
            }

            document.getElementById('dash-categories').textContent = categories.length;
        }

        function addNewCategory() {
            const inputEl = document.getElementById('newCategoryInput');
            const newCat = inputEl.value.trim();
            
            if (newCat) {
                 // ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏£‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏ç‡πà ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å
                 const formattedCat = newCat.charAt(0).toUpperCase() + newCat.slice(1).toLowerCase();

                if (!categories.includes(formattedCat)) {
                    categories.push(formattedCat);
                    saveCategories();
                    inputEl.value = '';
                    renderCategoryButtons('categorySelection', 'selectedCategory', formattedCat); // ‡∏™‡πà‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏õ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                    showToast(`‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà "${formattedCat}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`);
                } else {
                    showToast(`‚ö†Ô∏è ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà "${formattedCat}" ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß`, 'warning');
                    // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
                    document.querySelector(`#categorySelection [data-category="${formattedCat}"]`).click();
                    inputEl.value = '';
                }
            }
        }
        
        // =============================================================
        // 5. ‡∏´‡∏ô‡πâ‡∏≤ Dashboard
        // =============================================================
        
        function updateDashboard() {
            const total = inventory.length;
            const available = inventory.filter(item => item.Status === 'Available').length;
            const withdrawn = total - available;
            
            document.getElementById('dash-total').textContent = total;
            document.getElementById('dash-available').textContent = available;
            document.getElementById('dash-withdrawn').textContent = withdrawn;
            document.getElementById('dash-categories').textContent = categories.length;
            
            updateRecentItems();
        }
        
        function updateRecentItems() {
            const recentContainer = document.getElementById('recentItems');
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ (‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤ ReceiveDate ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÑ‡∏î‡πâ)
            const sortedInventory = [...inventory].sort((a, b) => new Date(b.ReceiveDate) - new Date(a.ReceiveDate));
            const recentItems = sortedInventory.slice(0, 5);
            
            recentContainer.innerHTML = '';
            
            if (recentItems.length === 0) {
                 recentContainer.innerHTML = `<p class="text-sm text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>`;
                 return;
            }

            recentItems.forEach(item => {
                const statusColor = item.Status === 'Available' ? 'bg-emerald-100 text-emerald-800' : 'bg-orange-100 text-orange-800';
                
                const itemDiv = document.createElement('div');
                itemDiv.className = 'flex justify-between items-center p-3 bg-white rounded-lg border border-gray-200 shadow-sm';
                itemDiv.innerHTML = `
                    <div class="truncate">
                        <span class="font-medium text-gray-700">${item.SN}</span> 
                        <span class="text-xs text-gray-500 ml-2">(${item.Category})</span>
                    </div>
                    <span class="text-xs font-semibold px-2 py-1 rounded-full ${statusColor}">
                        ${item.Status === 'Available' ? '‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠' : '‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß'}
                    </span>
                `;
                recentContainer.appendChild(itemDiv);
            });
        }

        // =============================================================
        // 6. ‡∏´‡∏ô‡πâ‡∏≤ Receive (‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤)
        // =============================================================

        async function addItems(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('receiveSubmitBtn');
            const spinner = document.getElementById('receiveSpinner');
            
            submitBtn.disabled = true;
            spinner.classList.remove('hidden');

            const serialNumbersText = document.getElementById('serialNumbers').value.toUpperCase();
            const snList = serialNumbersText.split('\n').map(sn => sn.trim()).filter(sn => sn.length > 0);
            const category = document.getElementById('selectedCategory').value;
            const receiveDate = updateDateTime(); 

            if (!category) {
                showToast(document.getElementById('selectedCategory').dataset.validationMessage, 'error');
                submitBtn.disabled = false;
                spinner.classList.add('hidden');
                return;
            }

            const newItems = [];
            const duplicateSNs = [];
            const existingSNs = inventory.map(item => item.SN);

            // 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö SN ‡∏ã‡πâ‡∏≥‡∏Å‡πà‡∏≠‡∏ô
            snList.forEach(sn => {
                if (existingSNs.includes(sn)) {
                    duplicateSNs.push(sn);
                } else {
                    newItems.push({
                        SN: sn,
                        Category: category,
                        Status: 'Available',
                        ReceiveDate: receiveDate,
                        WithdrawDate: '',
                        Technician: ''
                    });
                }
            });

            if (duplicateSNs.length > 0) {
                showToast(`‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ ${duplicateSNs.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: ‡∏°‡∏µ Serial Number ‡∏ã‡πâ‡∏≥`, 'error');
                console.error('Duplicate SNs:', duplicateSNs);
            }
            
            if (newItems.length > 0) {
                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤ Local Inventory
                inventory.push(...newItems);
                saveInventory(); 
                clearReceiveForm();
                showToast(`‚úÖ ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${newItems.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, 'success');

                // 2. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Apps Script (‡∏ñ‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß)
                if (settings.webAppUrl) {
                    await fetchData('add', newItems); 
                }
            } else if (duplicateSNs.length === snList.length) {
                showToast(`‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÄ‡∏•‡∏¢: Serial Number ‡∏ã‡πâ‡∏≥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î`, 'error');
            }

            submitBtn.disabled = false;
            spinner.classList.add('hidden');
        }
        
        function addSingleItem(event) {
            event.preventDefault();
            
            const sn = document.getElementById('modalSN').value.toUpperCase().trim();
            const category = document.getElementById('modalSelectedCategory').value;
            const receiveDate = updateDateTime(); 

            if (!category) {
                 showToast(document.getElementById('modalSelectedCategory').dataset.validationMessage, 'error');
                 return;
            }
            
            if (inventory.some(item => item.SN === sn)) {
                showToast(`‚ö†Ô∏è Serial Number "${sn}" ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß`, 'error');
                return;
            }

            const newItem = {
                SN: sn,
                Category: category,
                Status: 'Available',
                ReceiveDate: receiveDate,
                WithdrawDate: '',
                Technician: ''
            };

            inventory.push(newItem);
            saveInventory();
            hideAddItemModal();
            
            showToast(`‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ "${sn}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`, 'success');

            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Apps Script
            if (settings.webAppUrl) {
                fetchData('add', [newItem]); 
            }
        }
        
        function showAddItemModal() {
            document.getElementById('addItemModal').classList.remove('hidden');
            document.getElementById('modalSN').value = '';
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ Render Category ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß
            renderCategoryButtons('modalCategorySelection', 'modalSelectedCategory');
        }

        function hideAddItemModal() {
            document.getElementById('addItemModal').classList.add('hidden');
        }

        // =============================================================
        // 7. ‡∏´‡∏ô‡πâ‡∏≤ Withdraw (‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢)
        // =============================================================

        function checkAvailability() {
            const snText = document.getElementById('withdrawSN').value.toUpperCase();
            const snList = snText.split('\n').map(sn => sn.trim()).filter(sn => sn.length > 0);
            const checkResults = document.getElementById('checkResults');
            const checkContainer = document.getElementById('availabilityCheck');
            checkResults.innerHTML = '';
            checkContainer.classList.remove('hidden');
            
            if (snList.length === 0) {
                 checkResults.innerHTML = `<p class="text-sm text-gray-500">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Serial Number ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</p>`;
                 return;
            }

            let allAvailable = true;

            snList.forEach(sn => {
                const item = inventory.find(i => i.SN === sn);
                const resultDiv = document.createElement('p');
                resultDiv.className = 'text-sm';

                if (!item) {
                    resultDiv.innerHTML = `<span class="text-red-500 font-medium">${sn}</span>: ‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á`;
                    allAvailable = false;
                } else if (item.Status === 'Withdrawn') {
                    resultDiv.innerHTML = `<span class="text-orange-500 font-medium">${sn}</span>: ‚ö†Ô∏è ‡∏ñ‡∏π‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡πÇ‡∏î‡∏¢ ${item.Technician} (${item.WithdrawDate})`;
                    allAvailable = false;
                } else {
                    resultDiv.innerHTML = `<span class="text-emerald-500 font-medium">${sn}</span>: ‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ö‡∏¥‡∏Å (${item.Category})`;
                }
                checkResults.appendChild(resultDiv);
            });
            
            if (allAvailable && snList.length > 0) {
                showToast('‚úÖ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢', 'success');
            } else if (!allAvailable) {
                showToast('‚ö†Ô∏è ‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢ (‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)', 'warning');
            }
        }

        async function withdrawItems(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('withdrawSubmitBtn');
            const spinner = document.getElementById('withdrawSpinner');
            
            submitBtn.disabled = true;
            spinner.classList.remove('hidden');

            const snText = document.getElementById('withdrawSN').value.toUpperCase();
            const snList = snText.split('\n').map(sn => sn.trim()).filter(sn => sn.length > 0);
            const technicianName = document.getElementById('technicianName').value.trim();
            const withdrawDate = updateDateTime();
            
            if (snList.length === 0 || !technicianName) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Serial Number ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å', 'error');
                submitBtn.disabled = false;
                spinner.classList.add('hidden');
                return;
            }

            const withdrawnItems = [];
            const failedWithdrawals = [];
            
            let itemsToSync = [];
            
            snList.forEach(sn => {
                const itemIndex = inventory.findIndex(i => i.SN === sn);
                if (itemIndex > -1) {
                    const item = inventory[itemIndex];
                    if (item.Status === 'Available') {
                        // ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å
                        inventory[itemIndex].Status = 'Withdrawn';
                        inventory[itemIndex].WithdrawDate = withdrawDate;
                        inventory[itemIndex].Technician = technicianName;
                        withdrawnItems.push(sn);
                        
                        // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå 
                        itemsToSync.push({ 
                            SN: sn, 
                            Technician: technicianName, 
                            WithdrawDate: withdrawDate
                        });
                    } else {
                        failedWithdrawals.push(`${sn} (‡∏ñ‡∏π‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß)`);
                    }
                } else {
                    failedWithdrawals.push(`${sn} (‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á)`);
                }
            });

            if (withdrawnItems.length > 0) {
                saveInventory();
                clearWithdrawForm();
                showToast(`‚úÖ ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${withdrawnItems.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, 'success');
                
                // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Apps Script
                if (settings.webAppUrl) {
                    await fetchData('withdraw', itemsToSync); 
                }
            }

            if (failedWithdrawals.length > 0) {
                 showToast(`‚ö†Ô∏è ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${failedWithdrawals.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: ${failedWithdrawals.slice(0, 3).join(', ')}...`, 'error');
            }
            
            if (withdrawnItems.length === 0 && failedWithdrawals.length > 0) {
                 showToast('‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÄ‡∏•‡∏¢', 'error');
            }

            submitBtn.disabled = false;
            spinner.classList.add('hidden');
        }

        // =============================================================
        // 8. ‡∏´‡∏ô‡πâ‡∏≤ Inventory (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤)
        // =============================================================

        function filterInventory() {
            const filterText = document.getElementById('searchSN').value.toUpperCase();
            const statusFilter = document.getElementById('statusFilter').value;
            
            let filtered = inventory.filter(item => {
                const matchesSN = item.SN.toUpperCase().includes(filterText) || 
                                  item.Category.toUpperCase().includes(filterText);
                const matchesStatus = statusFilter === '' || item.Status === statusFilter;
                return matchesSN && matchesStatus;
            });
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° SN
            filtered.sort((a, b) => a.SN.localeCompare(b.SN));

            currentInventoryPage = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå
            updateInventoryDisplay(filtered);
        }

        function updateInventoryDisplay(data = null) {
            const tableBody = document.getElementById('inventoryTable');
            const paginationContainer = document.getElementById('inventoryPagination');
            const filteredData = data || inventory;
            
            tableBody.innerHTML = '';
            paginationContainer.innerHTML = '';
            
            if (filteredData.length === 0) {
                tableBody.innerHTML = `<tr class="text-center"><td colspan="7" class="py-4 text-gray-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</td></tr>`;
                return;
            }

            const totalPages = Math.ceil(filteredData.length / ITEMS_PER_PAGE);
            const startIndex = (currentInventoryPage - 1) * ITEMS_PER_PAGE;
            const endIndex = startIndex + ITEMS_PER_PAGE;
            const pageItems = filteredData.slice(startIndex, endIndex);

            pageItems.forEach(item => {
                const row = tableBody.insertRow();
                const statusColor = item.Status === 'Available' ? 'bg-emerald-100 text-emerald-800' : 'bg-orange-100 text-orange-800';
                
                row.className = 'border-b border-gray-100 hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-4 py-3 text-sm font-medium text-gray-800">${item.SN}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${item.Category}</td>
                    <td class="px-4 py-3 text-xs text-gray-500">${formatDate(item.ReceiveDate)}</td>
                    <td class="px-4 py-3 text-xs">
                        <span class="px-2 py-1 rounded-full font-semibold ${statusColor}">
                            ${item.Status === 'Available' ? '‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠' : '‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß'}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-sm text-gray-600">${item.Technician || '-'}</td>
                    <td class="px-4 py-3 text-xs text-gray-500">${formatDate(item.WithdrawDate || '-')}</td>
                    <td class="px-4 py-3 text-center">
                        <button onclick="showEditItemModal('${item.SN}')" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç" class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-edit"></i></button>
                        <button onclick="deleteItem('${item.SN}')" title="‡∏•‡∏ö" class="text-red-600 hover:text-red-800"><i class="fas fa-trash-alt"></i></button>
                    </td>
                `;
            });
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á Pagination
            if (totalPages > 1) {
                for (let i = 1; i <= totalPages; i++) {
                    const button = document.createElement('button');
                    button.textContent = i;
                    button.className = `px-3 py-1 mx-1 rounded-lg text-sm font-medium transition-colors ${
                        i === currentInventoryPage 
                            ? 'bg-blue-600 text-white' 
                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                    }`;
                    button.onclick = () => {
                        currentInventoryPage = i;
                        updateInventoryDisplay(filteredData);
                    };
                    paginationContainer.appendChild(button);
                }
            }
        }
        
        function formatDate(dateString) {
            if (!dateString || dateString === '-') return '-';
            try {
                const date = new Date(dateString + 'T00:00:00'); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Timezone Offset
                return date.toLocaleDateString('th-TH', { day: '2-digit', month: '2-digit', year: 'numeric' });
            } catch (e) {
                return dateString;
            }
        }
        
        function showEditItemModal(sn) {
            const item = inventory.find(i => i.SN === sn);
            if (!item) {
                showToast(`‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ SN: ${sn}`, 'error');
                return;
            }
            
            document.getElementById('editSN').value = item.SN;
            document.getElementById('editTechnician').value = item.Technician || '';
            
            // Render category buttons ‡πÉ‡∏ô Modal ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
            renderCategoryButtons('editCategorySelection', 'editSelectedCategory', item.Category);
            
            document.getElementById('editItemModal').classList.remove('hidden');
        }

        function hideEditItemModal() {
            document.getElementById('editItemModal').classList.add('hidden');
        }
        
        async function saveEditItem(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('editSubmitBtn');
            const spinner = document.getElementById('editSpinner');
            submitBtn.disabled = true;
            spinner.classList.remove('hidden');

            const sn = document.getElementById('editSN').value;
            const newCategory = document.getElementById('editSelectedCategory').value;
            const newTechnician = document.getElementById('editTechnician').value.trim();
            
            const itemIndex = inventory.findIndex(i => i.SN === sn);

            if (itemIndex > -1) {
                const oldItem = inventory[itemIndex];

                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Local Inventory
                inventory[itemIndex].Category = newCategory;
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß)
                if (oldItem.Status === 'Withdrawn') {
                    inventory[itemIndex].Technician = newTechnician;
                } else if (newTechnician && oldItem.Status === 'Available') {
                    // ‡∏´‡∏≤‡∏Å‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ö‡∏¥‡∏Å ‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô Withdrawn ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                    inventory[itemIndex].Status = 'Withdrawn';
                    inventory[itemIndex].Technician = newTechnician;
                    inventory[itemIndex].WithdrawDate = updateDateTime();
                    showToast(`‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥`, 'warning');
                } else if (!newTechnician && oldItem.Status === 'Withdrawn') {
                    // ‡∏´‡∏≤‡∏Å‡∏•‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô Available
                    inventory[itemIndex].Status = 'Available';
                    inventory[itemIndex].Technician = '';
                    inventory[itemIndex].WithdrawDate = '';
                    showToast(`‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Available)`, 'warning');
                }

                saveInventory();
                hideEditItemModal();
                showToast(`‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ SN: ${sn} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`, 'success');
                
                // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Apps Script
                if (settings.webAppUrl) {
                    await fetchData('edit', inventory[itemIndex]); 
                }
                
            } else {
                showToast(`‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ SN: ${sn}`, 'error');
            }
            
            submitBtn.disabled = false;
            spinner.classList.add('hidden');
        }

        function deleteItem(sn) {
            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ SN: ${sn} ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                const initialLength = inventory.length;
                inventory = inventory.filter(item => item.SN !== sn);
                
                if (inventory.length < initialLength) {
                    saveInventory();
                    showToast(`‚úÖ ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ SN: ${sn} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`, 'success');
                    
                    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Apps Script
                    if (settings.webAppUrl) {
                        fetchData('delete', { SN: sn }); 
                    }
                } else {
                    showToast(`‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ SN: ${sn} ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö`, 'error');
                }
            }
        }


        // =============================================================
        // 9. ‡∏´‡∏ô‡πâ‡∏≤ Settings (‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤)
        // =============================================================

        function saveWebAppUrl() {
            const url = document.getElementById('webAppUrl').value.trim();
            if (url) {
                settings.webAppUrl = url;
                localStorage.setItem('storeSettings', JSON.stringify(settings));
                updateConnectionStatus('active', '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL Apps Script ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                showToast('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            } else {
                settings.webAppUrl = '';
                localStorage.setItem('storeSettings', JSON.stringify(settings));
                updateConnectionStatus('inactive', '‚ö†Ô∏è ‡∏•‡πâ‡∏≤‡∏á URL Apps Script ‡πÅ‡∏•‡πâ‡∏ß');
                showToast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å URL ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'warning');
            }
        }

        async function testGoogleSheetsConnection() {
            if (!settings.webAppUrl) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö', 'error');
                updateConnectionStatus('inactive', '‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ URL Apps Script');
                return;
            }
            
            updateConnectionStatus('info', '‚åõ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...');
            
            const testPayload = { message: 'TEST_CONNECTION' };

            try {
                const response = await fetch(settings.webAppUrl, {
                    method: 'POST',
                    mode: 'cors',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: new URLSearchParams({ action: 'test', data: JSON.stringify(testPayload) }).toString()
                });

                const result = await response.json();

                if (response.ok && result.status === 'success' && result.message === 'Test connection successful!') {
                    updateConnectionStatus('test-success', 'üéâ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    showToast('üéâ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Apps Script ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                } else {
                    throw new Error(result.message || 'Server returned an unknown error.');
                }
            } catch (error) {
                console.error('Connection Test Error:', error);
                updateConnectionStatus('test-fail', `‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`);
                showToast('üö® ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£ Deploy)', 'error');
            }
        }

        function exportToCSV() {
            if (inventory.length === 0) {
                 showToast('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å', 'warning');
                 return;
            }
            
            const header = ["Serial Number", "‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤", "‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å (ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å"];
            const csvRows = [];
            csvRows.push(header.join(','));

            inventory.forEach(item => {
                const values = [
                    `"${item.SN}"`, // ‡πÉ‡∏™‡πà quotes ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏°‡∏µ comma ‡πÉ‡∏ô SN
                    `"${item.Category}"`,
                    `"${item.Status === 'Available' ? '‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠' : '‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß'}"`,
                    `"${item.ReceiveDate}"`,
                    `"${item.Technician || ''}"`,
                    `"${item.WithdrawDate || ''}"`
                ];
                csvRows.push(values.join(','));
            });

            const csvString = csvRows.join('\n');
            const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('href', url);
            a.setAttribute('download', 'inventory_report_' + new Date().toISOString().split('T')[0] + '.csv');
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showToast('üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function backupData() {
            const data = {
                inventory: inventory,
                categories: categories,
                settings: settings
            };
            
            const jsonString = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('href', url);
            a.setAttribute('download', 'store_manager_backup_' + new Date().toISOString().split('T')[0] + '.json');
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showToast('üíæ ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (JSON) ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function clearAllData() {
            if (confirm("‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á Apps Script URL)? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ!")) {
                inventory = [];
                categories = []; // <--- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß
                settings = { webAppUrl: '' };
                
                localStorage.removeItem('storeInventory');
                localStorage.removeItem('storeCategories');
                localStorage.removeItem('storeSettings');
                
                loadSettings();
                showPage('dashboard');
                clearReceiveForm();
                clearWithdrawForm();
                updateAllDisplays();
                showToast('üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß', 'success');
            }
        }

        function printReport() {
            // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ Inventory ‡∏Å‡πà‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå
            showPage('inventory');
            setTimeout(() => {
                window.print();
            }, 100); 
        }

    </script>
</body>
</html>
