<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Store Manager Pro)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom Styles & Animation */
        body { box-sizing: border-box; }
        .page { display: none; }
        .page.active { display: block; }
        .nav-item.active { background-color: #3b82f6; color: white; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            padding: 24px;
            margin-bottom: 24px;
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° Category */
        .category-button {
            transition: all 0.2s;
            white-space: nowrap;
        }
        .category-button.selected {
            background-color: #10b981; /* emerald-500 */
            color: white;
            box-shadow: 0 2px 4px rgba(16, 185, 129, 0.5);
            border-color: #10b981;
        }

        /* Toast Notifications */
        #toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        .toast {
            animation: slideIn 0.3s ease-out, fadeOut 0.5s ease-in 3s forwards;
            min-width: 250px;
            max-width: 350px;
            margin-top: 10px;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes fadeOut {
            0% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Print Styles */
        @media print {
            body > *:not(.container) { display: none; }
            .container { margin: 0; padding: 0; width: 100%; max-width: none; background: white; }
            #inventory { display: block !important; }
            .page { display: block !important; }
            .card { box-shadow: none; border: 1px solid #ccc; }
            #inventory .flex.justify-between.items-center.mb-6 { display: none; }
            #inventoryPagination { display: none; }
            table { font-size: 9pt; width: 100%; border-collapse: collapse; }
            th, td { padding: 4px 6px; border: 1px solid #ddd; }
            /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå */
            .status-withdrawn { color: #666 !important; } 
            .status-available { color: #000 !important; font-weight: bold; }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-full font-sans">
    
    <div id="toast-container"></div>

    <script>
        // WEB_APP_URL ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Local Storage ‡πÉ‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô loadSettings()
        const DEFAULT_WEB_APP_URL = "URL APPS SCRIPT WEB APP"; // ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô URL ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    </script>

    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-6">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-2">
                    <div class="text-2xl text-blue-600">üì¶</div>
                    <h1 class="text-xl font-extrabold text-gray-800">STORE MANAGER PRO</h1>
                </div>
                
                <div class="flex space-x-1 text-sm">
                    <button onclick="showPage('dashboard')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-dashboard">
                        üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
                    </button>
                    <button onclick="showPage('receive')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-receive">
                        üì• ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤
                    </button>
                    <button onclick="showPage('withdraw')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-withdraw">
                        üì§ ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢
                    </button>
                    <button onclick="showPage('inventory')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-inventory">
                        üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                    </button>
                    <button onclick="showPage('settings')" class="nav-item px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100" id="nav-settings">
                        ‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-6 py-8">
        <div id="dashboard" class="page active">
            <div class="card fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üìä ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                
                <div class="grid md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-blue-600 text-white p-6 rounded-xl shadow-lg">
                        <p class="text-blue-100">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                        <p class="text-4xl font-extrabold mt-1" id="dash-total">0</p>
                    </div>
                    <div class="bg-emerald-500 text-white p-6 rounded-xl shadow-lg">
                        <p class="text-emerald-100">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á</p>
                        <p class="text-4xl font-extrabold mt-1" id="dash-available">0</p>
                    </div>
                    <div class="bg-orange-500 text-white p-6 rounded-xl shadow-lg">
                        <p class="text-orange-100">‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
                        <p class="text-4xl font-extrabold mt-1" id="dash-withdrawn">0</p>
                    </div>
                    <div class="bg-gray-700 text-white p-6 rounded-xl shadow-lg">
                        <p class="text-gray-300">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                        <p class="text-4xl font-extrabold mt-1" id="dash-categories">0</p>
                    </div>
                </div>

                <div class="grid lg:grid-cols-2 gap-6">
                    <div class="bg-gray-50 p-6 rounded-xl">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800">üöÄ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
                        <div class="space-y-3">
                            <button onclick="showPage('receive')" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-xl transition-colors flex items-center justify-center space-x-2 font-medium">
                                <span>üì•</span>
                                <span>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á</span>
                            </button>
                            <button onclick="showPage('withdraw')" class="w-full bg-orange-600 hover:bg-orange-700 text-white py-3 px-4 rounded-xl transition-colors flex items-center justify-center space-x-2 font-medium">
                                <span>üì§</span>
                                <span>‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-xl">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800">üìà ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h3>
                        <div id="recentItems" class="space-y-2">
                            <p class="text-sm text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="receive" class="page">
            <div class="card fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üì• ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                
                <form onsubmit="addItems(event)" class="space-y-6">
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div>
                            <label for="serialNumbers" class="block text-lg font-semibold text-gray-700 mb-3">üìù Serial Numbers (SN)</label>
                            <textarea id="serialNumbers" rows="10" 
                                        placeholder="‡πÉ‡∏™‡πà Serial Number ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î&#10;&#10;‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:&#10;SN-PRT-001&#10;SN-PRT-002&#10;SN-PRT-003" 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-base" required></textarea>
                            <p class="text-sm text-gray-500 mt-2">üí° ‡πÉ‡∏™‡πà SN ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÅ‡∏¢‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</p>
                        </div>
                        
                        <div class="space-y-6">
                            
                            <div class="space-y-3">
                                <label class="block text-lg font-semibold text-gray-700 mb-3">üè∑Ô∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                                
                                <div id="categorySelection" class="flex flex-wrap gap-2 mb-4 p-3 bg-gray-50 rounded-lg border min-h-[50px]">
                                    <p class="text-sm text-gray-500 w-full">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà...</p>
                                </div>

                                <div class="flex items-center space-x-3">
                                    <input type="text" id="newCategoryInput" 
                                            placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà" 
                                            class="flex-grow px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <button type="button" onclick="addNewCategory(document.getElementById('newCategoryInput').value, 'receive')" 
                                            class="bg-gray-700 hover:bg-gray-800 text-white px-4 py-3 rounded-xl transition-colors font-medium text-sm whitespace-nowrap">
                                        + ‡πÄ‡∏û‡∏¥‡πà‡∏°
                                    </button>
                                </div>
                                <input type="hidden" id="selectedCategory" required data-validation-message="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà">
                            </div>
                            
                            <div class="bg-blue-50 p-4 rounded-xl border border-blue-200">
                                <h4 class="font-bold text-blue-800 mb-2 text-lg">üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</h4>
                                <p class="text-sm text-blue-600">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <span id="currentDate" class="font-medium"></span></p>
                                <p class="text-sm text-blue-600">üë§ ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤: ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-4 pt-4">
                        <button type="button" onclick="clearReceiveForm()" 
                                class="px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 transition-colors font-medium">
                            ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                        <button type="submit" id="receiveSubmitBtn"
                                class="px-8 py-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-xl transition-colors font-bold shadow-lg shadow-emerald-200 flex items-center justify-center space-x-2">
                            <span>‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á</span>
                            <i id="receiveSpinner" class="fas fa-circle-notch fa-spin hidden"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="withdraw" class="page">
            <div class="card fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üì§ ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                
                <form onsubmit="withdrawItems(event)" class="space-y-6">
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div>
                            <label for="withdrawSN" class="block text-lg font-semibold text-gray-700 mb-3">üîç Serial Numbers ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å</label>
                            <textarea id="withdrawSN" rows="8" 
                                        placeholder="‡πÉ‡∏™‡πà Serial Number ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å&#10;&#10;‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:&#10;SN-PRT-001&#10;SN-PRT-002" 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500 font-mono text-base" required></textarea>
                            <button type="button" onclick="checkAvailability()" 
                                            class="mt-2 text-sm text-orange-600 hover:text-orange-700 underline font-medium">
                                üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°
                            </button>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label for="technicianName" class="block text-lg font-semibold text-gray-700 mb-3">üë§ ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å / ‡∏ä‡πà‡∏≤‡∏á (ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)</label>
                                <input type="text" id="technicianName" 
                                            placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏´‡∏£‡∏∑‡∏≠ ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å" 
                                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500" required>
                            </div>
                            
                            <div class="bg-orange-50 p-4 rounded-xl border border-orange-200">
                                <h4 class="font-bold text-orange-800 mb-2 text-lg">üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å</h4>
                                <p class="text-sm text-orange-600">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å: <span id="withdrawDate" class="font-medium"></span></p>
                            </div>
                        </div>
                    </div>
                    
                    <div id="availabilityCheck" class="hidden bg-gray-50 p-4 rounded-xl border border-gray-300">
                        <h4 class="font-bold text-gray-800 mb-2">üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°</h4>
                        <div id="checkResults" class="space-y-1"></div>
                    </div>
                    
                    <div class="flex justify-end space-x-4 pt-4">
                        <button type="button" onclick="clearWithdrawForm()" 
                                class="px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 transition-colors font-medium">
                            ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                        <button type="submit" id="withdrawSubmitBtn"
                                class="px-8 py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-xl transition-colors font-bold shadow-lg shadow-orange-200 flex items-center justify-center space-x-2">
                            <span>‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢</span>
                            <i id="withdrawSpinner" class="fas fa-circle-notch fa-spin hidden"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="inventory" class="page">
            <div class="card fade-in">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                    <div class="flex space-x-3">
                        <button onclick="showAddItemModal()" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl text-sm transition-colors flex items-center space-x-1 font-medium shadow-md">
                            <span>‚ûï</span>
                            <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</span>
                        </button>
                        <select id="statusFilter" onchange="filterInventory()" 
                                class="px-4 py-2 border border-gray-300 rounded-xl text-sm">
                            <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                            <option value="Available">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</option>
                            <option value="Withdrawn">‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß</option>
                        </select>
                        <input type="text" id="searchSN" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ SN ‡∏´‡∏£‡∏∑‡∏≠ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà..." 
                               onkeyup="filterInventory()"
                               class="px-4 py-2 border border-gray-300 rounded-xl text-sm w-56">
                    </div>
                </div>
                
                <div class="overflow-x-auto rounded-lg border">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gray-50 border-b border-gray-200">
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[20%]">Serial Number</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[20%]">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[10%]">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[10%]">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[20%]">‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å (ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700 w-[10%]">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å</th>
                                <th class="px-4 py-3 text-center font-semibold text-gray-700 w-[10%]">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryTable">
                            <tr id="empty-inventory-row" class="text-center"><td colspan="7" class="py-4 text-gray-500">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î/‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div id="inventoryPagination" class="mt-6 flex justify-center">
                    </div>
            </div>
        </div>

        <div id="settings" class="page">
            <div class="space-y-8 fade-in">
                
                <div class="card border-t-4 border-blue-600">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">‚òÅÔ∏è Google Sheets Sync (Apps Script)</h2>
                    <p class="text-sm text-gray-600 mb-4">
                        ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ **Google Apps Script Web App URL** ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á <br>
                        *‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ä‡∏µ‡∏ó '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤' ‡πÅ‡∏•‡∏∞ '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢' ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£*
                    </p>

                    <div class="space-y-4">
                        <div>
                            <label for="webAppUrl" class="block text-sm font-medium text-gray-700 mb-2">Google Apps Script Web App URL</label>
                            <input type="url" id="webAppUrl" placeholder="‡πÉ‡∏™‡πà URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy Apps Script" 
                                            class="w-full px-3 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm" required>
                        </div>
                        <div id="connectionStatus" class="text-sm font-medium">
                            <span class="text-gray-500">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL</span>
                        </div>
                    </div>
                    
                    <div class="flex space-x-4 mt-6">
                        <button onclick="saveWebAppUrl()" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-xl transition-colors font-medium shadow-md">
                            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL
                        </button>
                        <button onclick="testGoogleSheetsConnection()" 
                                class="bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-2 rounded-xl transition-colors font-medium shadow-md">
                            üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                        </button>
                    </div>
                </div>

                <div class="card border-t-4 border-gray-700">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üóÇÔ∏è ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                    <div class="grid md:grid-cols-3 gap-4">
                        <button onclick="exportToCSV()" 
                                class="bg-gray-700 hover:bg-gray-800 text-white px-6 py-3 rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                            <span>üìä</span>
                            <span>‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</span>
                        </button>
                        <button onclick="backupData()" 
                                class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                            <span>üíæ</span>
                            <span>‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (JSON)</span>
                        </button>
                        <button onclick="clearAllData()" 
                                class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                            <span>üóëÔ∏è</span>
                            <span>‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                        </button>
                    </div>
                </div>

                <div class="card border-t-4 border-indigo-600">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h2>
                    <button onclick="printReport()" 
                            class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-xl transition-colors font-medium flex items-center justify-center space-x-2 w-full md:w-auto">
                        <span>üñ®Ô∏è</span>
                        <span>‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="addItemModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md mx-auto shadow-2xl">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (1 ‡∏ä‡∏¥‡πâ‡∏ô)</h3>
                <button type="button" onclick="hideAddItemModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <form onsubmit="addSingleItem(event)" class="space-y-4">
                <div>
                    <label for="modalSN" class="block text-sm font-medium text-gray-700 mb-2">üìù Serial Number</label>
                    <input type="text" id="modalSN" placeholder="‡πÉ‡∏™‡πà Serial Number" 
                            class="w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">üè∑Ô∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                    <div id="modalCategorySelection" class="flex flex-wrap gap-2 p-3 bg-gray-50 rounded-lg border min-h-[50px]">
                        <p class="text-sm text-gray-500 w-full">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà...</p>
                    </div>
                    <input type="hidden" id="modalSelectedCategory" required data-validation-message="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà">
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="hideAddItemModal()" 
                            class="px-5 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 transition-colors font-medium">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button type="submit" id="modalSubmitBtn"
                            class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                        <span>‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                        <i id="modalSpinner" class="fas fa-circle-notch fa-spin hidden"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="editItemModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md mx-auto shadow-2xl">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                <button type="button" onclick="hideEditItemModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <form onsubmit="saveEditItem(event)" class="space-y-4">
                <div>
                    <label for="editSN" class="block text-sm font-medium text-gray-700 mb-2">üìù Serial Number</label>
                    <input type="text" id="editSN" class="w-full px-4 py-2 border border-gray-300 rounded-xl bg-gray-100 text-gray-600" readonly>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">üè∑Ô∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                    <div id="editCategorySelection" class="flex flex-wrap gap-2 p-3 bg-gray-50 rounded-lg border min-h-[50px]"></div>
                    <input type="hidden" id="editSelectedCategory" required data-validation-message="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà">
                </div>

                <div>
                    <label for="editTechnician" class="block text-sm font-medium text-gray-700 mb-2">üë§ ‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß)</label>
                    <input type="text" id="editTechnician" placeholder="‡∏ä‡∏∑‡πà‡∏≠/ID ‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å" 
                            class="w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="hideEditItemModal()" 
                            class="px-5 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 transition-colors font-medium">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button type="submit" id="editSubmitBtn"
                            class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-colors font-medium flex items-center justify-center space-x-2">
                        <span>üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</span>
                        <i id="editSpinner" class="fas fa-circle-notch fa-spin hidden"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>


    <script>
        // =============================================================
        // 1. ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        // =============================================================

        let inventory = [];
        let categories = []; 
        let settings = JSON.parse(localStorage.getItem('storeSettings')) || { webAppUrl: DEFAULT_WEB_APP_URL };
        let currentPage = 'dashboard';
        const ITEMS_PER_PAGE = 10;
        let currentInventoryPage = 1;
        let filteredInventory = []; // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏≠‡∏á/‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤

        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            initializeDataFromSheets(); // <-- ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Apps Script
            showPage('dashboard');
            updateDateTime();
            setInterval(updateDateTime, 1000); 
        });

        // --------------------------------------------------------------------
        // [‡πÉ‡∏´‡∏°‡πà] ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å Apps Script
        // --------------------------------------------------------------------
        async function initializeDataFromSheets() {
            const url = settings.webAppUrl;
            
            // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Local Storage ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ú‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏™‡∏°‡∏≠
            inventory = JSON.parse(localStorage.getItem('storeInventory')) || [];
            categories = JSON.parse(localStorage.getItem('storeCategories')) || [];
            updateAllDisplays(); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô

            if (!url || url === DEFAULT_WEB_APP_URL) {
                showToast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Apps Script URL ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤". ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Local Storage', 'warning');
                return;
            }

            showToast('‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å Google Sheets...', 'info');
            
            try {
                // ‡πÉ‡∏ä‡πâ GET request ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å doGet(e)
                const response = await fetch(url, {
                    method: 'GET', // ‡πÉ‡∏ä‡πâ GET
                    mode: 'cors'
                });
                
                const result = await response.json();

                if (result.status === 'success' && result.data) {
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ Inventory ‡πÅ‡∏•‡∏∞ Categories ‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Sheets
                    inventory = result.data.inventory || [];
                    categories = result.data.categories || [];

                    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡πÉ‡∏ô Local Storage (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ Offline)
                    localStorage.setItem('storeInventory', JSON.stringify(inventory));
                    localStorage.setItem('storeCategories', JSON.stringify(categories));

                    showToast(`‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${inventory.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`, 'success');
                } else {
                    showToast(`‚ùå ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${result.message}. ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Local Storage ‡∏™‡∏≥‡∏£‡∏≠‡∏á.`, 'error');
                }
                
            } catch (error) {
                console.error('Initial data fetch error:', error);
                showToast('‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (GET). ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á Local Storage', 'error');
            }

            updateAllDisplays(); 
        }

        // --------------------------------------------------------------------
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏•‡∏∞ UI
        // --------------------------------------------------------------------

        function loadSettings() {
            if (settings.webAppUrl && settings.webAppUrl !== DEFAULT_WEB_APP_URL) {
                document.getElementById('webAppUrl').value = settings.webAppUrl;
                updateConnectionStatus('active', '‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ URL ‡πÅ‡∏•‡πâ‡∏ß');
            } else {
                document.getElementById('webAppUrl').value = DEFAULT_WEB_APP_URL;
                updateConnectionStatus('inactive', '‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ URL Apps Script');
            }
        }
        
        function updateConnectionStatus(type, message) {
            const statusEl = document.getElementById('connectionStatus');
            let color = 'gray';
            if (type === 'active' || type === 'test-success') color = 'green';
            else if (type === 'error' || type === 'test-fail') color = 'red';
            else if (type === 'testing') color = 'yellow';

            statusEl.innerHTML = `<span class="text-${color}-600">${message}</span>`;
        }

        function updateDateTime() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('th-TH', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            document.getElementById('currentDate').textContent = dateStr;
            document.getElementById('withdrawDate').textContent = dateStr;
        }

        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            
            let bgColor = 'bg-emerald-500';
            let icon = '<i class="fas fa-check-circle"></i>';
            if (type === 'error') {
                bgColor = 'bg-red-500';
                icon = '<i class="fas fa-times-circle"></i>';
            } else if (type === 'warning') {
                bgColor = 'bg-orange-500';
                icon = '<i class="fas fa-exclamation-triangle"></i>';
            } else if (type === 'info') {
                 bgColor = 'bg-blue-500';
                icon = '<i class="fas fa-info-circle"></i>';
            }

            toast.className = `toast ${bgColor} text-white p-4 rounded-xl shadow-lg flex items-center space-x-3`;
            toast.innerHTML = `${icon} <span>${message}</span>`;
            
            container.prepend(toast); // ‡πÉ‡∏™‡πà‡πÑ‡∏ß‡πâ‡∏ö‡∏ô‡∏™‡∏∏‡∏î
            
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 500); // ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å DOM ‡∏´‡∏•‡∏±‡∏á Animation
            }, 4000); 
        }

        function showPage(pageId) {
            currentPage = pageId;
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active', 'fade-in');

            document.querySelectorAll('.nav-item').forEach(nav => {
                nav.classList.remove('active');
            });
            document.getElementById(`nav-${pageId}`).classList.add('active');

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å
            if (pageId === 'inventory') {
                filterInventory(); // ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
            } else if (pageId === 'receive') {
                renderCategoryButtons('receive');
            } else if (pageId === 'dashboard') {
                updateDashboard();
            }
        }

        // =============================================================
        // 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Local Storage & Sync)
        // =============================================================
        
        function saveInventory() {
            localStorage.setItem('storeInventory', JSON.stringify(inventory));
            updateAllDisplays(); 
        }

        function saveCategories() {
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö
            categories = [...new Set(categories.map(c => String(c).trim()).filter(c => c))].sort(); 
            localStorage.setItem('storeCategories', JSON.stringify(categories));
            updateAllDisplays(); 
            renderCategoryButtons('receive');
            renderCategoryButtons('modal');
            renderCategoryButtons('edit'); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
        }

        function updateAllDisplays() {
            updateDashboard();
            if (currentPage === 'inventory') {
                filterInventory();
            }
            renderCategoryButtons('receive');
            renderCategoryButtons('modal');
        }

        // --------------------------------------------------------------------
        // Dashboard
        // --------------------------------------------------------------------

        function updateDashboard() {
            const total = inventory.length;
            const available = inventory.filter(item => item.status === 'Available').length;
            const withdrawn = total - available;
            
            document.getElementById('dash-total').textContent = total;
            document.getElementById('dash-available').textContent = available;
            document.getElementById('dash-withdrawn').textContent = withdrawn;
            document.getElementById('dash-categories').textContent = categories.length;

            // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (Last 5 items received/withdrawn)
            const recentItemsEl = document.getElementById('recentItems');
            recentItemsEl.innerHTML = '';

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å (‡πÉ‡∏ä‡πâ Date Received ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å)
            const sortedInventory = [...inventory].sort((a, b) => {
                const dateA = new Date(a.dateWithdrawn || a.dateReceived);
                const dateB = new Date(b.dateWithdrawn || b.dateReceived);
                return dateB - dateA;
            });

            const recent = sortedInventory.slice(0, 5);

            if (recent.length === 0) {
                 recentItemsEl.innerHTML = '<p class="text-sm text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>';
            } else {
                recent.forEach(item => {
                    const statusText = item.status === 'Withdrawn' ? 'üì§ ‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß' : 'üì• ‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤';
                    const dateText = item.status === 'Withdrawn' ? item.dateWithdrawn : item.dateReceived;
                    const techText = item.status === 'Withdrawn' && item.technician ? ` | ‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å: ${item.technician}` : '';
                    
                    const itemEl = document.createElement('div');
                    itemEl.className = 'flex justify-between items-center text-sm border-b pb-1 last:border-b-0';
                    itemEl.innerHTML = `
                        <p class="font-medium text-gray-700">${item.serialNumber}</p>
                        <p class="text-gray-500 text-xs">${statusText} ${dateText} ${techText}</p>
                    `;
                    recentItemsEl.appendChild(itemEl);
                });
            }
        }

        // --------------------------------------------------------------------
        // Category Management
        // --------------------------------------------------------------------

        function renderCategoryButtons(target) {
            let containerId;
            let hiddenInputId;
            
            if (target === 'receive') {
                containerId = 'categorySelection';
                hiddenInputId = 'selectedCategory';
            } else if (target === 'modal') {
                containerId = 'modalCategorySelection';
                hiddenInputId = 'modalSelectedCategory';
            } else if (target === 'edit') {
                containerId = 'editCategorySelection';
                hiddenInputId = 'editSelectedCategory';
            } else {
                return;
            }

            const container = document.getElementById(containerId);
            const hiddenInput = document.getElementById(hiddenInputId);
            const currentSelected = hiddenInput.value;

            container.innerHTML = '';

            if (categories.length === 0) {
                container.innerHTML = '<p class="text-sm text-gray-500 w-full">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</p>';
                return;
            }

            categories.forEach(category => {
                const button = document.createElement('button');
                button.type = 'button';
                button.textContent = category;
                button.className = `category-button px-3 py-1 text-sm rounded-full border border-emerald-300 text-emerald-700 bg-emerald-50 hover:bg-emerald-100`;
                
                if (category === currentSelected) {
                    button.classList.add('selected');
                }

                button.onclick = () => selectCategory(category, hiddenInputId, containerId);
                container.appendChild(button);
            });

            // Re-select category if it exists
            if (currentSelected) {
                selectCategory(currentSelected, hiddenInputId, containerId);
            }
        }

        function selectCategory(category, hiddenInputId, containerId) {
            const hiddenInput = document.getElementById(hiddenInputId);
            const container = document.getElementById(containerId);
            
            hiddenInput.value = category;

            // Update button styles
            container.querySelectorAll('.category-button').forEach(btn => {
                btn.classList.remove('selected');
            });

            const selectedButton = Array.from(container.querySelectorAll('.category-button')).find(btn => btn.textContent === category);
            if (selectedButton) {
                selectedButton.classList.add('selected');
            }
        }

        function addNewCategory(newCategory, target) {
            newCategory = newCategory ? String(newCategory).trim() : '';
            if (!newCategory) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà', 'warning');
                return;
            }
            
            if (categories.includes(newCategory)) {
                showToast(`‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà "${newCategory}" ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß`, 'warning');
            } else {
                categories.push(newCategory);
                saveCategories();
                showToast(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà "${newCategory}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`, 'success');
            }
            
            // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå input
            let hiddenInputId;
            if (target === 'receive') hiddenInputId = 'selectedCategory';
            else if (target === 'modal') hiddenInputId = 'modalSelectedCategory';
            
            if (hiddenInputId) {
                selectCategory(newCategory, hiddenInputId, target === 'receive' ? 'categorySelection' : 'modalCategorySelection');
            }
            document.getElementById('newCategoryInput').value = '';
        }

        // =============================================================
        // 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Receive)
        // =============================================================

        async function addItems(event) {
            event.preventDefault();
            
            const serialNumbersText = document.getElementById('serialNumbers').value;
            const category = document.getElementById('selectedCategory').value;
            const submitBtn = document.getElementById('receiveSubmitBtn');
            const spinner = document.getElementById('receiveSpinner');

            if (!category) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤', 'error');
                return;
            }

            const sns = serialNumbersText.split('\n')
                                        .map(sn => sn.trim())
                                        .filter(sn => sn);
            
            if (sns.length === 0) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Serial Number ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', 'error');
                return;
            }

            submitBtn.disabled = true;
            spinner.classList.remove('hidden');

            const now = new Date().toISOString().split('T')[0]; // YYYY-MM-DD
            const itemsToAdd = sns.map(sn => ({
                serialNumber: sn,
                category: category,
                dateReceived: now,
                status: 'Available',
                technician: '',
                dateWithdrawn: ''
            }));
            
            try {
                // 1. Sync Data to Google Sheets
                const syncResult = await sendToGoogleSheets('addItems', itemsToAdd);

                if (syncResult.success) {
                    // 2. Update Local Inventory on successful sync
                    inventory.unshift(...itemsToAdd); // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
                    saveInventory(); 
                    clearReceiveForm();
                    showToast(syncResult.message, 'success');
                } else {
                    showToast(`‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: ${syncResult.message}. (‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô Local Storage)`, 'error');
                }

            } catch (error) {
                console.error('Add Items Error:', error);
                showToast('‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (POST). ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Apps Script URL', 'error');
            } finally {
                submitBtn.disabled = false;
                spinner.classList.add('hidden');
            }
        }

        function clearReceiveForm() {
            document.getElementById('serialNumbers').value = '';
            document.getElementById('selectedCategory').value = '';
            renderCategoryButtons('receive');
        }

        // =============================================================
        // 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Withdraw)
        // =============================================================

        function getItemsForWithdrawal(sns) {
            const items = [];
            const notFound = [];
            const notAvailable = [];

            sns.forEach(sn => {
                const item = inventory.find(i => i.serialNumber === sn);
                if (!item) {
                    notFound.push(sn);
                } else if (item.status === 'Withdrawn') {
                    notAvailable.push(sn);
                } else {
                    items.push(item);
                }
            });

            return { items, notFound, notAvailable };
        }

        function checkAvailability() {
            const serialNumbersText = document.getElementById('withdrawSN').value;
            const sns = serialNumbersText.split('\n').map(sn => sn.trim()).filter(sn => sn);
            const resultsDiv = document.getElementById('checkResults');
            const availabilityCheckDiv = document.getElementById('availabilityCheck');

            if (sns.length === 0) {
                availabilityCheckDiv.classList.add('hidden');
                return;
            }

            const { items, notFound, notAvailable } = getItemsForWithdrawal(sns);
            
            resultsDiv.innerHTML = '';

            if (items.length > 0) {
                resultsDiv.innerHTML += `<p class="text-emerald-600 font-medium">‚úÖ ${items.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ö‡∏¥‡∏Å:</p>`;
                items.forEach(item => {
                    resultsDiv.innerHTML += `<p class="ml-4 text-sm text-emerald-800">- ${item.serialNumber} (${item.category})</p>`;
                });
            }

            if (notFound.length > 0) {
                resultsDiv.innerHTML += `<p class="text-red-600 font-medium mt-2">‚ùå ${notFound.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á:</p>`;
                notFound.forEach(sn => {
                    resultsDiv.innerHTML += `<p class="ml-4 text-sm text-red-800">- ${sn}</p>`;
                });
            }

            if (notAvailable.length > 0) {
                resultsDiv.innerHTML += `<p class="text-orange-600 font-medium mt-2">‚ö†Ô∏è ${notAvailable.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß:</p>`;
                notAvailable.forEach(sn => {
                    const item = inventory.find(i => i.serialNumber === sn);
                    resultsDiv.innerHTML += `<p class="ml-4 text-sm text-orange-800">- ${sn} (‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å: ${item.technician || 'N/A'})</p>`;
                });
            }

            availabilityCheckDiv.classList.remove('hidden');
        }

        async function withdrawItems(event) {
            event.preventDefault();
            
            const serialNumbersText = document.getElementById('withdrawSN').value;
            const technicianName = document.getElementById('technicianName').value.trim();
            const submitBtn = document.getElementById('withdrawSubmitBtn');
            const spinner = document.getElementById('withdrawSpinner');

            const sns = serialNumbersText.split('\n')
                                        .map(sn => sn.trim())
                                        .filter(sn => sn);

            if (!technicianName) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å / ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô', 'error');
                return;
            }

            if (sns.length === 0) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Serial Number ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', 'error');
                return;
            }
            
            const { items, notFound, notAvailable } = getItemsForWithdrawal(sns);

            if (items.length === 0) {
                showToast('‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ö‡∏¥‡∏Å ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°', 'error');
                return;
            }

            submitBtn.disabled = true;
            spinner.classList.remove('hidden');

            const now = new Date().toISOString().split('T')[0]; // YYYY-MM-DD
            const itemsToUpdate = items.map(item => ({
                serialNumber: item.serialNumber,
                technician: technicianName,
                dateWithdrawn: now
            }));

            try {
                // 1. Sync Data to Google Sheets (‡∏à‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞ SN, Technician, DateWithdrawn ‡πÉ‡∏ô Inventory Sheet)
                const syncResult = await sendToGoogleSheets('withdrawItems', itemsToUpdate);

                if (syncResult.success) {
                    // 2. Update Local Inventory on successful sync
                    itemsToUpdate.forEach(updatedItem => {
                        const index = inventory.findIndex(i => i.serialNumber === updatedItem.serialNumber);
                        if (index !== -1) {
                            inventory[index].status = 'Withdrawn';
                            inventory[index].technician = updatedItem.technician;
                            inventory[index].dateWithdrawn = updatedItem.dateWithdrawn;
                        }
                    });

                    saveInventory(); 
                    clearWithdrawForm();
                    showToast(syncResult.message, 'success');
                } else {
                    showToast(`‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: ${syncResult.message}.`, 'error');
                }

            } catch (error) {
                console.error('Withdraw Items Error:', error);
                showToast('‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (POST). ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Apps Script URL', 'error');
            } finally {
                submitBtn.disabled = false;
                spinner.classList.add('hidden');
            }
        }

        function clearWithdrawForm() {
            document.getElementById('withdrawSN').value = '';
            document.getElementById('technicianName').value = '';
            document.getElementById('availabilityCheck').classList.add('hidden');
            document.getElementById('checkResults').innerHTML = '';
        }


        // =============================================================
        // 5. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Inventory Table & CRUD)
        // =============================================================

        function filterInventory(page = 1) {
            const statusFilter = document.getElementById('statusFilter').value;
            const searchSN = document.getElementById('searchSN').value.toLowerCase();
            
            filteredInventory = inventory.filter(item => {
                const statusMatch = statusFilter === '' || item.status === statusFilter;
                const searchMatch = searchSN === '' || 
                                    item.serialNumber.toLowerCase().includes(searchSN) || 
                                    item.category.toLowerCase().includes(searchSN);
                return statusMatch && searchMatch;
            });
            
            currentInventoryPage = page;
            renderInventoryTable(page);
        }

        function renderInventoryTable(page) {
            const tableBody = document.getElementById('inventoryTable');
            const paginationDiv = document.getElementById('inventoryPagination');
            
            tableBody.innerHTML = '';
            paginationDiv.innerHTML = '';

            const totalItems = filteredInventory.length;
            const totalPages = Math.ceil(totalItems / ITEMS_PER_PAGE);

            if (totalItems === 0) {
                tableBody.innerHTML = '<tr class="text-center"><td colspan="7" class="py-4 text-gray-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</td></tr>';
                return;
            }

            const startIndex = (page - 1) * ITEMS_PER_PAGE;
            const endIndex = startIndex + ITEMS_PER_PAGE;
            const itemsToDisplay = filteredInventory.slice(startIndex, endIndex);

            itemsToDisplay.forEach((item, index) => {
                const row = tableBody.insertRow();
                const statusClass = item.status === 'Withdrawn' ? 'bg-orange-50 text-gray-500 status-withdrawn' : 'bg-white text-gray-800 status-available';
                row.className = `border-b border-gray-200 hover:bg-gray-50 ${statusClass}`;
                
                const statusColor = item.status === 'Available' ? 'bg-emerald-100 text-emerald-800' : 'bg-orange-100 text-orange-800';
                
                row.innerHTML = `
                    <td class="px-4 py-3 font-medium">${item.serialNumber}</td>
                    <td class="px-4 py-3 text-sm">${item.category}</td>
                    <td class="px-4 py-3 text-sm">${item.dateReceived || 'N/A'}</td>
                    <td class="px-4 py-3 text-sm">
                        <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full ${statusColor}">
                            ${item.status === 'Available' ? '‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠' : '‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß'}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-sm">${item.technician || 'N/A'}</td>
                    <td class="px-4 py-3 text-sm">${item.dateWithdrawn || 'N/A'}</td>
                    <td class="px-4 py-3 text-center space-x-2">
                        <button onclick="showEditItemModal('${item.serialNumber}')" class="text-blue-600 hover:text-blue-800 transition-colors">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="confirmDeleteItem('${item.serialNumber}')" class="text-red-600 hover:text-red-800 transition-colors">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
            });

            // Pagination Controls
            if (totalPages > 1) {
                let paginationHtml = '';
                
                // Previous button
                paginationHtml += `<button onclick="filterInventory(${page - 1})" ${page === 1 ? 'disabled' : ''} class="px-3 py-1 text-sm rounded-l-lg border border-gray-300 bg-white hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed">‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>`;

                // Page buttons
                for (let i = 1; i <= totalPages; i++) {
                    const activeClass = i === page ? 'bg-blue-600 text-white' : 'bg-white text-gray-700 hover:bg-gray-100';
                    paginationHtml += `<button onclick="filterInventory(${i})" class="px-3 py-1 text-sm border-t border-b border-gray-300 ${activeClass}">${i}</button>`;
                }

                // Next button
                paginationHtml += `<button onclick="filterInventory(${page + 1})" ${page === totalPages ? 'disabled' : ''} class="px-3 py-1 text-sm rounded-r-lg border border-gray-300 bg-white hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>`;

                paginationDiv.innerHTML = paginationHtml;
            }
        }

        function showAddItemModal() {
            document.getElementById('addItemModal').classList.remove('hidden');
            document.getElementById('modalSN').focus();
            renderCategoryButtons('modal');
            document.getElementById('modalSelectedCategory').value = '';
        }

        function hideAddItemModal() {
            document.getElementById('addItemModal').classList.add('hidden');
            document.getElementById('modalSN').value = '';
            document.getElementById('modalSelectedCategory').value = '';
            renderCategoryButtons('modal'); // clear selection
        }

        async function addSingleItem(event) {
            event.preventDefault();
            
            const sn = document.getElementById('modalSN').value.trim();
            const category = document.getElementById('modalSelectedCategory').value;
            const submitBtn = document.getElementById('modalSubmitBtn');
            const spinner = document.getElementById('modalSpinner');

            if (!sn || !category) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Serial Number ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà', 'error');
                return;
            }

            const existingItem = inventory.find(i => i.serialNumber === sn);
            if (existingItem) {
                 showToast(`‚ùå Serial Number "${sn}" ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß (${existingItem.status})`, 'error');
                return;
            }

            submitBtn.disabled = true;
            spinner.classList.remove('hidden');

            const now = new Date().toISOString().split('T')[0]; // YYYY-MM-DD
            const item = [{
                serialNumber: sn,
                category: category,
                dateReceived: now,
                status: 'Available',
                technician: '',
                dateWithdrawn: ''
            }];

            try {
                const syncResult = await sendToGoogleSheets('addItems', item);

                if (syncResult.success) {
                    inventory.unshift(item[0]); // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
                    saveInventory(); 
                    hideAddItemModal();
                    showToast(`‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ${sn} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`, 'success');
                } else {
                    showToast(`‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: ${syncResult.message}.`, 'error');
                }

            } catch (error) {
                console.error('Add Single Item Error:', error);
                showToast('‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (POST). ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Apps Script URL', 'error');
            } finally {
                submitBtn.disabled = false;
                spinner.classList.add('hidden');
            }
        }

        function showEditItemModal(sn) {
            const item = inventory.find(i => i.serialNumber === sn);
            if (!item) {
                showToast(`‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö Serial Number ${sn}`, 'error');
                return;
            }

            document.getElementById('editSN').value = item.serialNumber;
            document.getElementById('editTechnician').value = item.technician || '';
            
            // Render category buttons for edit modal
            renderCategoryButtons('edit');
            selectCategory(item.category, 'editSelectedCategory', 'editCategorySelection');

            document.getElementById('editItemModal').classList.remove('hidden');
        }

        function hideEditItemModal() {
            document.getElementById('editItemModal').classList.add('hidden');
        }

        async function saveEditItem(event) {
            event.preventDefault();
            
            const sn = document.getElementById('editSN').value.trim();
            const category = document.getElementById('editSelectedCategory').value;
            const technician = document.getElementById('editTechnician').value.trim();
            const submitBtn = document.getElementById('editSubmitBtn');
            const spinner = document.getElementById('editSpinner');

            if (!sn || !category) {
                showToast('‚ùå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
                return;
            }
            
            submitBtn.disabled = true;
            spinner.classList.remove('hidden');

            const itemToEdit = {
                serialNumber: sn,
                category: category,
                technician: technician 
            };

            try {
                // 1. Sync Data to Google Sheets
                const syncResult = await sendToGoogleSheets('editItem', [itemToEdit]);

                if (syncResult.success) {
                    // 2. Update Local Inventory on successful sync
                    const index = inventory.findIndex(i => i.serialNumber === sn);
                    if (index !== -1) {
                        inventory[index].category = category;
                        inventory[index].technician = technician;
                    }
                    saveInventory(); 
                    hideEditItemModal();
                    showToast(syncResult.message, 'success');
                } else {
                    showToast(`‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: ${syncResult.message}.`, 'error');
                }

            } catch (error) {
                console.error('Edit Item Error:', error);
                showToast('‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (POST). ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Apps Script URL', 'error');
            } finally {
                submitBtn.disabled = false;
                spinner.classList.add('hidden');
            }
        }

        function confirmDeleteItem(sn) {
            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Serial Number: ${sn} ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ!`)) {
                deleteItem(sn);
            }
        }

        async function deleteItem(sn) {
            const itemToDelete = { serialNumber: sn };
            
            try {
                // 1. Sync Data to Google Sheets
                const syncResult = await sendToGoogleSheets('deleteItem', [itemToDelete]);

                if (syncResult.success) {
                    // 2. Update Local Inventory on successful sync
                    inventory = inventory.filter(item => item.serialNumber !== sn);
                    saveInventory(); 
                    showToast(syncResult.message, 'success');
                } else {
                    showToast(`‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö: ${syncResult.message}.`, 'error');
                }

            } catch (error) {
                console.error('Delete Item Error:', error);
                showToast('‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (POST). ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Apps Script URL', 'error');
            }
        }

        // =============================================================
        // 6. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets (Apps Script)
        // =============================================================
        
        async function sendToGoogleSheets(action, payload) {
            const url = settings.webAppUrl;

            if (!url || url === DEFAULT_WEB_APP_URL) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Apps Script URL ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤"', 'error');
                return { success: false, message: 'Apps Script URL not set.' };
            }

            const data = new URLSearchParams();
            data.append('action', action);
            data.append('data', JSON.stringify(payload));
            
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: data.toString()
                });

                const result = await response.json();
                
                if (result.status === 'success') {
                    return { success: true, message: result.message };
                } else {
                    return { success: false, message: result.message };
                }
            } catch (error) {
                console.error(`Error during ${action} sync:`, error);
                return { success: false, message: `Network/Server error: ${error.message}` };
            }
        }

        // =============================================================
        // 7. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (Settings)
        // =============================================================

        function saveWebAppUrl() {
            const newUrl = document.getElementById('webAppUrl').value.trim();
            if (newUrl) {
                settings.webAppUrl = newUrl;
                localStorage.setItem('storeSettings', JSON.stringify(settings));
                updateConnectionStatus('active', '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                showToast('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL Apps Script ‡πÅ‡∏•‡πâ‡∏ß', 'success');
                initializeDataFromSheets(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
            } else {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL Apps Script', 'error');
            }
        }

        async function testGoogleSheetsConnection() {
            const url = settings.webAppUrl;

            if (!url || url === DEFAULT_WEB_APP_URL) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL Apps Script ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö', 'error');
                return;
            }

            updateConnectionStatus('testing', '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...');

            const testPayload = [{ testKey: 'TestValue' }];
            
            try {
                const result = await sendToGoogleSheets('TEST', testPayload);
                
                if (result.success) {
                    updateConnectionStatus('test-success', `‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! (${result.message})`);
                    showToast('‚úÖ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                } else {
                    updateConnectionStatus('test-fail', `‚ùå ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${result.message}`);
                    showToast(`‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${result.message}`, 'error');
                }
            } catch (error) {
                updateConnectionStatus('test-fail', '‚ùå ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ');
                showToast('‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£ Deploy', 'error');
            }
        }

        function exportToCSV() {
            if (inventory.length === 0) {
                showToast('‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤', 'warning');
                return;
            }
            
            const headers = ["Serial Number", "‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å (ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å"];
            const csvData = inventory.map(item => [
                item.serialNumber,
                item.category,
                item.dateReceived,
                item.status,
                item.technician,
                item.dateWithdrawn
            ].map(field => `"${String(field).replace(/"/g, '""')}"`).join(',')); // escape quotes

            const csvContent = [headers.join(','), ...csvData].join('\n');
            const blob = new Blob([new Uint8Array([0xEF, 0xBB, 0xBF]), csvContent], { type: 'text/csv;charset=utf-8;' }); // Add BOM for Thai characters
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `store_inventory_export_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showToast('‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô CSV ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function backupData() {
            const backup = {
                timestamp: new Date().toISOString(),
                inventory: inventory,
                categories: categories,
                settings: settings
            };
            const jsonString = JSON.stringify(backup, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `store_manager_backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showToast('‚úÖ ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô JSON ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function clearAllData() {
            if (confirm('‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô! ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏ô Local Storage ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets ‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà) ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                localStorage.removeItem('storeInventory');
                localStorage.removeItem('storeCategories');
                inventory = [];
                categories = [];
                saveInventory(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                saveCategories(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                showToast('üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Local Storage ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                showPage('dashboard');
            }
        }

        function printReport() {
            // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            window.print();
        }

    </script>
</body>
</html>
